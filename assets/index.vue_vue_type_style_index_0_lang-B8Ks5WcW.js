import{W as Ke,bv as Le,cK as He,aV as Ue,d as te,an as Ie,ew as It,ex as wt,b4 as Qe,X as Ze,ey as _t,r as _,ez as $t,aY as Je,K as j,w as be,n as $e,a4 as et,o as g,c as Q,e as C,f as v,b6 as tt,B as b,Z as Y,i as w,C as ke,j as se,a0 as N,aj as pe,eA as St,F as L,G as re,b5 as Et,b7 as Vt,eB as Tt,eC as Mt,$ as lt,eD as Ot,eE as Pt,H as ye,M as Lt,N as Dt,Y as J,eF as Rt,a1 as nt,bG as Ee,bD as Ve,eG as Ft,a2 as ot,bS as At,eH as zt,bR as xt,cj as Pe,h as oe,bY as le,ck as Bt,b0 as Ut,eI as jt,eJ as Nt,eK as Gt,c$ as st,O as K,a6 as Te,g as ue,c6 as at,b$ as it,b as Ge,a_ as rt,c2 as je,c3 as Ne,eL as qt,d4 as Wt,cu as Yt,T as Xt,eM as Kt,eN as Ht,cB as Qt,cn as Zt,eO as Jt,ao as qe,eP as el,eQ as tl,P as ll,e9 as nl,bi as ol,e8 as sl,s as _e,cQ as ut,eR as al,cD as il,ag as rl,bu as ul,af as cl,a7 as dl,ai as ct,y as De,k as We,m as we,u as Fe,a as dt,l as mt,x as ft,z as Ae,p as ml,bs as fl,cp as pl,am as vl,cP as gl,eS as hl}from"./index-BiiIy8BH.js";import{i as yl}from"./index-n3iKJaD_.js";import{i as kl}from"./index-B9kzOIud.js";import{E as pt}from"./link-B4panqSh.js";import{E as vt}from"./tree-BvQcSpbV.js";import{E as Cl}from"./empty-B_ITTikW.js";import{i as bl}from"./index-C6LSuDqi.js";import{E as gt}from"./upload-BGO06KGh.js";import{E as Il}from"./progress-CCLXG-1J.js";import{V as wl}from"./vuedraggable.umd-CNv-yK7O.js";import{t as Be}from"./throttle-DiptQJvM.js";import{E as _l}from"./tree-select-B4mwEyeh.js";import{u as $l}from"./message-box-D2dYDAIw.js";const ht=Ke({urlList:{type:Le(Array),default:()=>He([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:Le(String)}}),Sl={close:()=>!0,switch:e=>Ue(e),rotate:e=>Ue(e)},El=te({name:"ElImageViewer"}),Vl=te({...El,props:ht,emits:Sl,setup(e,{expose:t,emit:s}){var n;const o=e,y={CONTAIN:{name:"contain",icon:Ie(It)},ORIGINAL:{name:"original",icon:Ie(wt)}},{t:u}=Qe(),i=Ze("image-viewer"),{nextZIndex:d}=_t(),l=_(),I=_([]),p=$t(),f=_(!0),a=_(o.initialIndex),c=Je(y.CONTAIN),h=_({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),O=_((n=o.zIndex)!=null?n:d()),P=j(()=>{const{urlList:T}=o;return T.length<=1}),x=j(()=>a.value===0),W=j(()=>a.value===o.urlList.length-1),X=j(()=>o.urlList[a.value]),H=j(()=>[i.e("btn"),i.e("prev"),i.is("disabled",!o.infinite&&x.value)]),ae=j(()=>[i.e("btn"),i.e("next"),i.is("disabled",!o.infinite&&W.value)]),E=j(()=>{const{scale:T,deg:r,offsetX:m,offsetY:S,enableTransition:$}=h.value;let R=m/T,z=S/T;const A=r*Math.PI/180,ie=Math.cos(A),Se=Math.sin(A);R=R*ie+z*Se,z=z*ie-m/T*Se;const ve={transform:`scale(${T}) rotate(${r}deg) translate(${R}px, ${z}px)`,transition:$?"transform .3s":""};return c.value.name===y.CONTAIN.name&&(ve.maxWidth=ve.maxHeight="100%"),ve});function B(){D(),s("close")}function k(){const T=Be(m=>{switch(m.code){case Ee.esc:o.closeOnPressEscape&&B();break;case Ee.space:ce();break;case Ee.left:ne();break;case Ee.up:q("zoomIn");break;case Ee.right:V();break;case Ee.down:q("zoomOut");break}}),r=Be(m=>{const S=m.deltaY||m.deltaX;q(S<0?"zoomIn":"zoomOut",{zoomRate:o.zoomRate,enableTransition:!1})});p.run(()=>{Ve(document,"keydown",T),Ve(document,"wheel",r)})}function D(){p.stop()}function G(){f.value=!1}function F(T){f.value=!1,T.target.alt=u("el.image.error")}function ee(T){if(f.value||T.button!==0||!l.value)return;h.value.enableTransition=!1;const{offsetX:r,offsetY:m}=h.value,S=T.pageX,$=T.pageY,R=Be(A=>{h.value={...h.value,offsetX:r+A.pageX-S,offsetY:m+A.pageY-$}}),z=Ve(document,"mousemove",R);Ve(document,"mouseup",()=>{z()}),T.preventDefault()}function de(){h.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ce(){if(f.value)return;const T=Ft(y),r=Object.values(y),m=c.value.name,$=(r.findIndex(R=>R.name===m)+1)%T.length;c.value=y[T[$]],de()}function me(T){const r=o.urlList.length;a.value=(T+r)%r}function ne(){x.value&&!o.infinite||me(a.value-1)}function V(){W.value&&!o.infinite||me(a.value+1)}function q(T,r={}){if(f.value)return;const{minScale:m,maxScale:S}=o,{zoomRate:$,rotateDeg:R,enableTransition:z}={zoomRate:o.zoomRate,rotateDeg:90,enableTransition:!0,...r};switch(T){case"zoomOut":h.value.scale>m&&(h.value.scale=Number.parseFloat((h.value.scale/$).toFixed(3)));break;case"zoomIn":h.value.scale<S&&(h.value.scale=Number.parseFloat((h.value.scale*$).toFixed(3)));break;case"clockwise":h.value.deg+=R,s("rotate",h.value.deg);break;case"anticlockwise":h.value.deg-=R,s("rotate",h.value.deg);break}h.value.enableTransition=z}return be(X,()=>{$e(()=>{const T=I.value[0];T!=null&&T.complete||(f.value=!0)})}),be(a,T=>{de(),s("switch",T)}),et(()=>{var T,r;k(),(r=(T=l.value)==null?void 0:T.focus)==null||r.call(T)}),t({setActiveItem:me}),(T,r)=>(g(),Q(w(Rt),{to:"body",disabled:!T.teleported},{default:C(()=>[v(tt,{name:"viewer-fade",appear:""},{default:C(()=>[b("div",{ref_key:"wrapper",ref:l,tabindex:-1,class:Y(w(i).e("wrapper")),style:ke({zIndex:O.value})},[b("div",{class:Y(w(i).e("mask")),onClick:se(m=>T.hideOnClickModal&&B(),["self"])},null,10,["onClick"]),N(" CLOSE "),b("span",{class:Y([w(i).e("btn"),w(i).e("close")]),onClick:B},[v(w(pe),null,{default:C(()=>[v(w(St))]),_:1})],2),N(" ARROW "),w(P)?N("v-if",!0):(g(),L(re,{key:0},[b("span",{class:Y(w(H)),onClick:ne},[v(w(pe),null,{default:C(()=>[v(w(Et))]),_:1})],2),b("span",{class:Y(w(ae)),onClick:V},[v(w(pe),null,{default:C(()=>[v(w(Vt))]),_:1})],2)],64)),N(" ACTIONS "),b("div",{class:Y([w(i).e("btn"),w(i).e("actions")])},[b("div",{class:Y(w(i).e("actions__inner"))},[v(w(pe),{onClick:m=>q("zoomOut")},{default:C(()=>[v(w(Tt))]),_:1},8,["onClick"]),v(w(pe),{onClick:m=>q("zoomIn")},{default:C(()=>[v(w(Mt))]),_:1},8,["onClick"]),b("i",{class:Y(w(i).e("actions__divider"))},null,2),v(w(pe),{onClick:ce},{default:C(()=>[(g(),Q(lt(w(c).icon)))]),_:1}),b("i",{class:Y(w(i).e("actions__divider"))},null,2),v(w(pe),{onClick:m=>q("anticlockwise")},{default:C(()=>[v(w(Ot))]),_:1},8,["onClick"]),v(w(pe),{onClick:m=>q("clockwise")},{default:C(()=>[v(w(Pt))]),_:1},8,["onClick"])],2)],2),N(" CANVAS "),b("div",{class:Y(w(i).e("canvas"))},[(g(!0),L(re,null,ye(T.urlList,(m,S)=>Lt((g(),L("img",{ref_for:!0,ref:$=>I.value[S]=$,key:m,src:m,style:ke(w(E)),class:Y(w(i).e("img")),crossorigin:T.crossorigin,onLoad:G,onError:F,onMousedown:ee},null,46,["src","crossorigin"])),[[Dt,S===a.value]])),128))],2),J(T.$slots,"default")],6)]),_:3})]),_:3},8,["disabled"]))}});var Tl=nt(Vl,[["__file","image-viewer.vue"]]);const yt=ot(Tl),Ml=Ke({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:Le([String,Object])},previewSrcList:{type:Le(Array),default:()=>He([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:Le(String)}}),Ol={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>Ue(e),close:()=>!0,show:()=>!0},Pl=te({name:"ElImage",inheritAttrs:!1}),Ll=te({...Pl,props:Ml,emits:Ol,setup(e,{emit:t}){const s=e;let n="";const{t:o}=Qe(),y=Ze("image"),u=At(),i=j(()=>zt(Object.entries(u).filter(([V])=>/^(data-|on[A-Z])/i.test(V)||["id","style"].includes(V)))),d=xt({excludeListeners:!0,excludeKeys:j(()=>Object.keys(i.value))}),l=_(),I=_(!1),p=_(!0),f=_(!1),a=_(),c=_(),h=Pe&&"loading"in HTMLImageElement.prototype;let O,P;const x=j(()=>[y.e("inner"),X.value&&y.e("preview"),p.value&&y.is("loading")]),W=j(()=>{const{fit:V}=s;return Pe&&V?{objectFit:V}:{}}),X=j(()=>{const{previewSrcList:V}=s;return Array.isArray(V)&&V.length>0}),H=j(()=>{const{previewSrcList:V,initialIndex:q}=s;let T=q;return q>V.length-1&&(T=0),T}),ae=j(()=>s.loading==="eager"?!1:!h&&s.loading==="lazy"||s.lazy),E=()=>{Pe&&(p.value=!0,I.value=!1,l.value=s.src)};function B(V){p.value=!1,I.value=!1,t("load",V)}function k(V){p.value=!1,I.value=!0,t("error",V)}function D(){Nt(a.value,c.value)&&(E(),ee())}const G=Gt(D,200,!0);async function F(){var V;if(!Pe)return;await $e();const{scrollContainer:q}=s;Bt(q)?c.value=q:Ut(q)&&q!==""?c.value=(V=document.querySelector(q))!=null?V:void 0:a.value&&(c.value=jt(a.value)),c.value&&(O=Ve(c,"scroll",G),setTimeout(()=>D(),100))}function ee(){!Pe||!c.value||!G||(O==null||O(),c.value=void 0)}function de(V){if(V.ctrlKey){if(V.deltaY<0)return V.preventDefault(),!1;if(V.deltaY>0)return V.preventDefault(),!1}}function ce(){X.value&&(P=Ve("wheel",de,{passive:!1}),n=document.body.style.overflow,document.body.style.overflow="hidden",f.value=!0,t("show"))}function me(){P==null||P(),document.body.style.overflow=n,f.value=!1,t("close")}function ne(V){t("switch",V)}return be(()=>s.src,()=>{ae.value?(p.value=!0,I.value=!1,ee(),F()):E()}),et(()=>{ae.value?F():E()}),(V,q)=>(g(),L("div",le({ref_key:"container",ref:a},w(i),{class:[w(y).b(),V.$attrs.class]}),[I.value?J(V.$slots,"error",{key:0},()=>[b("div",{class:Y(w(y).e("error"))},oe(w(o)("el.image.error")),3)]):(g(),L(re,{key:1},[l.value!==void 0?(g(),L("img",le({key:0},w(d),{src:l.value,loading:V.loading,style:w(W),class:w(x),crossorigin:V.crossorigin,onClick:ce,onLoad:B,onError:k}),null,16,["src","loading","crossorigin"])):N("v-if",!0),p.value?(g(),L("div",{key:1,class:Y(w(y).e("wrapper"))},[J(V.$slots,"placeholder",{},()=>[b("div",{class:Y(w(y).e("placeholder"))},null,2)])],2)):N("v-if",!0)],64)),w(X)?(g(),L(re,{key:2},[f.value?(g(),Q(w(yt),{key:0,"z-index":V.zIndex,"initial-index":w(H),infinite:V.infinite,"zoom-rate":V.zoomRate,"min-scale":V.minScale,"max-scale":V.maxScale,"url-list":V.previewSrcList,crossorigin:V.crossorigin,"hide-on-click-modal":V.hideOnClickModal,teleported:V.previewTeleported,"close-on-press-escape":V.closeOnPressEscape,onClose:me,onSwitch:ne},{default:C(()=>[V.$slots.viewer?(g(),L("div",{key:0},[J(V.$slots,"viewer")])):N("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):N("v-if",!0)],64)):N("v-if",!0)],16))}});var Dl=nt(Ll,[["__file","image.vue"]]);const Rl=ot(Dl),Fl=te({name:"FileGridItem",props:{item:{type:Object,required:!0},selectionType:String,selections:Array,current:Object,icons:Array,ctxMenuDropdownVisible:Boolean},emits:{click:e=>!0,checkChange:e=>!0,contextOpen:e=>!0},setup(e,{emit:t}){const s=_(null),n=j(()=>e.selectionType==="checkbox"||e.selectionType==="radio"),o=j(()=>!n.value||!e.item?!1:e.selectionType==="checkbox"?!!(e.selections&&e.selections.some(l=>l.key===e.item.key)):!!(e.current&&e.current.key===e.item.key)),y=j(()=>{var l,I,p;if(e.item.thumbnail)return e.item.thumbnail;if(e.icons){if(e.item.isDirectory)return(l=e.icons.find(f=>f.type==="dir"))==null?void 0:l.icon;if(e.item.name){const f=(I=e.icons.find(a=>a.suffixes?!!a.suffixes.find(c=>!!e.item.name.endsWith(c)):!1))==null?void 0:I.icon;if(f)return f}return(p=e.icons.find(f=>f.type==="file"))==null?void 0:p.icon}});return{dropdownTriggerRef:s,selectable:n,selected:o,icon:y,handleClick:()=>{t("click",e.item)},handleCheckChange:()=>{t("checkChange",e.item)},handleContextmenu:l=>{s.value!=null&&t("contextOpen",{item:e.item,triggerEl:s.value,e:l})}}}}),Al=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s},zl={class:"ele-file-list-item-icon"},xl=["src"],Bl=["title"],Ul=b("i",{class:"ele-file-list-checkbox is-checked"},null,-1),jl=[Ul];function Nl(e,t,s,n,o,y){return g(),L("div",{class:Y(["ele-file-list-item",{"is-checked":e.selected},{"is-active":e.ctxMenuDropdownVisible}]),onClick:t[3]||(t[3]=se((...u)=>e.handleClick&&e.handleClick(...u),["stop"]))},[b("div",{class:"ele-file-list-item-body",onContextmenu:t[0]||(t[0]=(...u)=>e.handleContextmenu&&e.handleContextmenu(...u))},[b("div",zl,[J(e.$slots,"icon",{icon:e.icon,item:e.item},()=>[b("img",{src:e.icon,class:Y({"ele-file-list-item-image":!!e.item.thumbnail})},null,10,xl)])]),J(e.$slots,"title",{item:e.item},()=>[b("div",{title:e.item.name,class:"ele-file-list-item-title"},oe(e.item.name),9,Bl)])],32),e.selectable?(g(),L("div",{key:0,class:"ele-file-list-item-checkbox",onClick:t[1]||(t[1]=se((...u)=>e.handleCheckChange&&e.handleCheckChange(...u),["stop"]))},jl)):N("",!0),b("div",{ref:"dropdownTriggerRef",class:"ele-file-list-item-dropdown",onClick:t[2]||(t[2]=se(()=>{},["stop"]))},null,512)],2)}const Gl=Al(Fl,[["render",Nl]]),ql=te({name:"FileGrid",components:{ReceiverView:st,FileGridItem:Gl},props:{data:Array,icons:Array,selectionType:String,selections:Array,current:Object,isCheckAll:Boolean,isIndeterminate:Boolean,checkAllText:String,selectedText:String,ctxMenuDropdownVisible:Boolean,contextMenuFileItem:Object},emits:{checkAllChange:()=>!0,itemClick:e=>!0,itemCheckChange:e=>!0,itemContextOpen:e=>!0},setup(e,{emit:t}){return{headerText:j(()=>!e.selections||!e.selections.length?e.checkAllText:e.selectedText?e.selectedText.replace(/\{\s*total\s*\}/g,String(e.selections.length)):""),handleCheckAllChange:()=>{t("checkAllChange")},handleItemClick:i=>{t("itemClick",i)},handleItemCheckChange:i=>{t("itemCheckChange",i)},handleItemContextOpen:i=>{t("itemContextOpen",i)}}}}),Wl=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s},Yl={key:0,class:"ele-file-list-header"},Xl={class:"ele-file-list-body"};function Kl(e,t,s,n,o,y){const u=K("FileGridItem"),i=K("ReceiverView");return g(),Q(i,{class:"ele-file-list"},{default:C(()=>[e.selectionType==="checkbox"?(g(),L("div",Yl,[b("div",{class:"ele-file-list-selection",onClick:t[0]||(t[0]=se((...d)=>e.handleCheckAllChange&&e.handleCheckAllChange(...d),["stop"]))},[b("i",{class:Y(["ele-file-list-checkbox",{"is-checked":e.isCheckAll},{"is-indeterminate":e.isIndeterminate}])},null,2),b("div",null,oe(e.headerText),1)])])):N("",!0),b("div",Xl,[(g(!0),L(re,null,ye(e.data,d=>(g(),Q(u,{key:d.key,item:d,selectionType:e.selectionType,selections:e.selections,current:e.current,icons:e.icons,ctxMenuDropdownVisible:e.ctxMenuDropdownVisible&&e.contextMenuFileItem===d,onClick:e.handleItemClick,onCheckChange:e.handleItemCheckChange,onContextOpen:e.handleItemContextOpen},Te({_:2},[ye(Object.keys(e.$slots),l=>({name:l,fn:C(I=>[J(e.$slots,l,le({ref_for:!0},I||{}))])}))]),1032,["item","selectionType","selections","current","icons","ctxMenuDropdownVisible","onClick","onCheckChange","onContextOpen"]))),128))])]),_:3})}const Hl=Wl(ql,[["render",Kl]]),Ql=te({name:"FileTableItem",props:{item:{type:Object,required:!0},selectionType:String,selections:Array,current:Object,icons:Array,columns:Array,ctxMenuDropdownVisible:Boolean},emits:{click:e=>!0,checkChange:e=>!0,contextOpen:e=>!0},setup(e,{emit:t}){const s=_(null),n=j(()=>e.selectionType==="checkbox"||e.selectionType==="radio"),o=j(()=>!n.value||!e.item?!1:e.selectionType==="checkbox"?!!(e.selections&&e.selections.some(l=>l.key===e.item.key)):!!(e.current&&e.current.key===e.item.key)),y=j(()=>{var l,I,p;if(e.item.thumbnail)return e.item.thumbnail;if(e.icons){if(e.item.isDirectory)return(l=e.icons.find(f=>f.type==="dir"))==null?void 0:l.icon;if(e.item.name){const f=(I=e.icons.find(a=>a.suffixes?!!a.suffixes.find(c=>!!e.item.name.endsWith(c)):!1))==null?void 0:I.icon;if(f)return f}return(p=e.icons.find(f=>f.type==="file"))==null?void 0:p.icon}});return{dropdownTriggerRef:s,selectable:n,selected:o,icon:y,handleClick:()=>{t("click",e.item)},handleCheckChange:()=>{t("checkChange",e.item)},handleContextmenu:l=>{s.value!=null&&t("contextOpen",{item:e.item,triggerEl:s.value,e:l})}}}}),Zl=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s},Jl={key:0,class:"ele-file-list-item-checkbox"},en={class:"ele-file-list-item-name"},tn={class:"ele-file-list-item-icon"},ln=["src"],nn=["title"],on={key:0,class:"ele-file-list-item-tools"};function sn(e,t,s,n,o,y){return g(),L("div",{class:Y(["ele-file-list-item",{"is-checked":e.selected},{"is-active":e.ctxMenuDropdownVisible}]),onClick:t[3]||(t[3]=se((...u)=>e.handleClick&&e.handleClick(...u),["stop"]))},[b("div",{class:"ele-file-list-item-body",onContextmenu:t[1]||(t[1]=(...u)=>e.handleContextmenu&&e.handleContextmenu(...u))},[e.selectable?(g(),L("div",Jl,[b("i",{class:Y(["ele-file-list-checkbox",{"is-radio":e.selectionType==="radio"},{"is-checked":e.selected}]),onClick:t[0]||(t[0]=se((...u)=>e.handleCheckChange&&e.handleCheckChange(...u),["stop"]))},null,2)])):N("",!0),b("div",en,[b("div",tn,[J(e.$slots,"icon",{icon:e.icon,item:e.item},()=>[b("img",{src:e.icon,class:Y({"ele-file-list-item-image":!!e.item.thumbnail})},null,10,ln)]),J(e.$slots,"title",{item:e.item},()=>[b("div",{title:e.item.name,class:"ele-file-list-item-title"},oe(e.item.name),9,nn)])]),e.$slots.tool?(g(),L("div",on,[J(e.$slots,"tool",{item:e.item})])):N("",!0)]),(g(!0),L(re,null,ye(e.columns,u=>(g(),L("div",{key:u.prop,style:ke(u.style),class:"ele-file-list-item-cell"},[u.slot&&!["icon","title","tool","contextMenu"].includes(u.slot)&&e.$slots[u.slot]?J(e.$slots,u.slot,{key:0,item:e.item,col:u}):e.item&&u&&u.prop?(g(),L(re,{key:1},[ue(oe(e.item[u.prop]),1)],64)):N("",!0)],4))),128))],32),b("div",{ref:"dropdownTriggerRef",class:"ele-file-list-item-dropdown",onClick:t[2]||(t[2]=se(()=>{},["stop"]))},null,512)],2)}const an=Zl(Ql,[["render",sn]]),rn=te({name:"FileSort",props:{sort:String,order:String,name:{type:String,required:!0}}}),un=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s};function cn(e,t,s,n,o,y){return g(),L("i",{class:Y(["ele-file-list-item-sort",{"is-asc":e.name===e.sort&&e.order==="asc"},{"is-desc":e.name===e.sort&&e.order==="desc"}])},null,2)}const dn=un(rn,[["render",cn]]),mn=te({name:"FileTable",components:{ReceiverView:st,FileTableItem:an,FileSort:dn},props:{data:Array,icons:Array,selectionType:String,selections:Array,current:Object,isCheckAll:Boolean,isIndeterminate:Boolean,nameText:String,sizeText:String,timeText:String,sortable:Boolean,sort:String,order:String,columns:Array,ctxMenuDropdownVisible:Boolean,contextMenuFileItem:Object},emits:{checkAllChange:()=>!0,itemClick:e=>!0,itemCheckChange:e=>!0,itemContextOpen:e=>!0,sortChange:e=>!0},setup(e,{emit:t}){return{tableCols:j(()=>e.columns?e.columns:[{title:e.sizeText,prop:"length",style:{width:"120px",flexShrink:0},sortable:e.sortable},{title:e.timeText,prop:"updateTime",style:{width:"180px",flexShrink:0},sortable:e.sortable}]),handleCheckAllChange:()=>{t("checkAllChange")},handleItemClick:d=>{t("itemClick",d)},handleItemCheckChange:d=>{t("itemCheckChange",d)},handleSortChange:(d,l)=>{l?l.sortable&&t("sortChange",d):e.sortable&&t("sortChange",d)},handleItemContextOpen:d=>{t("itemContextOpen",d)}}}}),fn=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s},pn={class:"ele-file-list-header"},vn={class:"ele-file-list-item"},gn={class:"ele-file-list-item-body"},hn={key:0,class:"ele-file-list-item-checkbox"},yn=["onClick"],kn={class:"ele-file-list-body"};function Cn(e,t,s,n,o,y){const u=K("FileSort"),i=K("FileTableItem"),d=K("ReceiverView");return g(),Q(d,{class:"ele-file-list-table"},{default:C(()=>[b("div",pn,[b("div",vn,[b("div",gn,[e.selectionType==="checkbox"||e.selectionType==="radio"?(g(),L("div",hn,[e.selectionType==="checkbox"?(g(),L("i",{key:0,class:Y(["ele-file-list-checkbox",{"is-checked":e.isCheckAll},{"is-indeterminate":e.isIndeterminate}]),onClick:t[0]||(t[0]=se((...l)=>e.handleCheckAllChange&&e.handleCheckAllChange(...l),["stop"]))},null,2)):N("",!0)])):N("",!0),b("div",{class:Y(["ele-file-list-item-name",{"is-sortable":e.sortable}]),onClick:t[1]||(t[1]=l=>e.handleSortChange("name"))},[b("span",null,oe(e.nameText),1),e.sortable?(g(),Q(u,{key:0,sort:e.sort,order:e.order,name:"name"},null,8,["sort","order"])):N("",!0)],2),(g(!0),L(re,null,ye(e.tableCols,l=>(g(),L("div",{key:l.prop,style:ke(l.headerStyle||l.style),class:Y(["ele-file-list-item-cell",{"is-sortable":l.sortable}]),onClick:I=>e.handleSortChange(l.prop,l)},[b("span",null,[l.headerSlot&&!["icon","title","tool","contextMenu"].includes(l.headerSlot)&&e.$slots[l.headerSlot]?J(e.$slots,l.headerSlot,{key:0,col:l}):(g(),L(re,{key:1},[ue(oe(l.title),1)],64))]),l.sortable?(g(),Q(u,{key:0,sort:e.sort,order:e.order,name:l.prop},null,8,["sort","order","name"])):N("",!0)],14,yn))),128))])])]),b("div",kn,[(g(!0),L(re,null,ye(e.data,l=>(g(),Q(i,{key:l.key,item:l,selectionType:e.selectionType,selections:e.selections,current:e.current,icons:e.icons,columns:e.tableCols,ctxMenuDropdownVisible:e.ctxMenuDropdownVisible&&e.contextMenuFileItem===l,onClick:e.handleItemClick,onCheckChange:e.handleItemCheckChange,onContextOpen:e.handleItemContextOpen},Te({_:2},[ye(Object.keys(e.$slots),I=>({name:I,fn:C(p=>[J(e.$slots,I,le({ref_for:!0},p||{}))])}))]),1032,["item","selectionType","selections","current","icons","columns","ctxMenuDropdownVisible","onClick","onCheckChange","onContextOpen"]))),128))])]),_:3})}const bn=fn(mn,[["render",Cn]]),Ye=[{icon:"/ele-file-list/ic_file_misc_sm.png",type:"file"},{icon:"/ele-file-list/ic_file_folder_sm.png",type:"dir"},{icon:"/ele-file-list/ic_file_code_sm.png",suffixes:[".java",".js",".css",".vue",".ts",".tsx",".scss",".less",".c",".cpp",".cs",".jsp",".php",".asp",".py",".go",".kt",".lua"]},{icon:"/ele-file-list/ic_file_htm_sm.png",suffixes:[".html",".htm"]},{icon:"/ele-file-list/ic_file_text_sm.png",suffixes:[".txt"]},{icon:"/ele-file-list/ic_file_pdf_sm.png",suffixes:[".pdf"]},{icon:"/ele-file-list/ic_file_word_sm.png",suffixes:[".doc",".docx"]},{icon:"/ele-file-list/ic_file_excel_sm.png",suffixes:[".xls",".xlsx"]},{icon:"/ele-file-list/ic_file_ppt_sm.png",suffixes:[".ppt",".pptx"]},{icon:"/ele-file-list/ic_file_visio_sm.png",suffixes:[".vsd"]},{icon:"/ele-file-list/ic_file_ps_sm.png",suffixes:[".psd"]},{icon:"/ele-file-list/ic_file_cad_sm.png",suffixes:[".dwg"]},{icon:"/ele-file-list/ic_file_flash_sm.png",suffixes:[".swf"]},{icon:"/ele-file-list/ic_file_music_sm.png",suffixes:[".mp3",".wav"]},{icon:"/ele-file-list/ic_file_video_sm.png",suffixes:[".mp4",".rmvb",".flv",".avi",".3gp"]},{icon:"/ele-file-list/ic_file_picture_sm.png",suffixes:[".png",".jpg",".jpeg",".gif",".bmp"]},{icon:"/ele-file-list/ic_file_fonts_sm.png",suffixes:[".ttf",".woff"]},{icon:"/ele-file-list/ic_file_bt_sm.png",suffixes:[".torrent"]},{icon:"/ele-file-list/ic_file_android_sm.png",suffixes:[".apk"]},{icon:"/ele-file-list/ic_file_exe_sm.png",suffixes:[".exe"]},{icon:"/ele-file-list/ic_file_ipa_sm.png",suffixes:[".ipa",".dmg"]},{icon:"/ele-file-list/ic_file_zip_sm.png",suffixes:[".zip",".rar",".7z"]}],In=Ye.map(e=>({...e,icon:e.icon.replace("_sm.png",".png")})),wn=Ye.map(e=>({...e,icon:e.icon.replace("/ele-file-list/","https://cdn.eleadmin.com/20200609/")})),_n=wn.map(e=>({...e,icon:e.icon.replace("_sm.png",".png")})),$n={data:{type:Array,required:!0},selectionType:String,selections:Array,current:Object,grid:{type:Boolean,default:!0},sortable:Boolean,sort:String,order:String,icons:{type:Array,default:()=>_n},smallIcons:Array,columns:Array,boxChoose:Boolean,contextMenus:[Array,Function],contextMenuProps:Object,locale:Object},Sn={itemClick:e=>!0,sortChange:e=>!0,"update:selections":e=>!0,"update:current":e=>!0,itemContextMenu:e=>!0,itemContextOpen:(e,t)=>!0},En=".ele-file-list-body>.ele-file-list-item",Vn=te({name:"EleFileList",components:{EleDropdown:at,FileGrid:Hl,FileTable:bn},props:$n,emits:Sn,setup(e,{emit:t}){const{lang:s}=it("fileList",e),n=Ge({top:"0px",left:"0px",width:"0px",height:"0px",display:"none"}),o=_(null),y=Je([]),u=_(),i=_(!1),d=_(null),l=j(()=>!!(e.data&&e.data.length&&e.selections&&e.selections.length&&!e.data.some(k=>{var D,G;return!((G=(D=e.selections)==null?void 0:D.some)!=null&&G.call(D,F=>k.key===F.key))}))),I=j(()=>!!(!l.value&&e.selections&&e.selections.length)),p=k=>{t("update:selections",k)},f=k=>{t("update:current",k)},a=()=>{if(e.selectionType!=="checkbox")return;if(l.value||e.data==null||!e.data.length){if(!e.selections){p([]);return}const D=e.selections.filter(G=>e.data?!e.data.some(F=>F.key===G.key):!0);p(D);return}if(!e.selections){p([...e.data]);return}const k=e.selections.concat(e.data.filter(D=>e.selections?!e.selections.some(G=>G.key===D.key):!0));p(k)},c=k=>{if(e.selectionType==="radio"){f(e.current&&e.current.key===k.key?null:k);return}if(e.selectionType==="checkbox"){if(!e.selections||!e.selections.length){p([k]);return}if(!e.selections.some(D=>D.key===k.key)){p(e.selections.concat([k]));return}p(e.selections.filter(D=>D.key!==k.key))}},h=k=>{t("itemClick",k)},O=k=>{const D={sort:k};e.order&&k===e.sort?D.order=e.order==="asc"?"desc":null:D.order="asc",t("sortChange",D)},P=k=>{t("itemContextMenu",k)},x=k=>{d.value!=null&&t("itemContextMenu",{key:k,item:d.value})},W=k=>{i.value=k,k&&o.value!=null&&d.value!=null&&t("itemContextOpen",o.value,d.value)},X=k=>typeof e.contextMenus=="function"?e.contextMenus(k):e.contextMenus,H=()=>{o.value&&o.value.handleClose()},ae=(k,D)=>{d.value!=null&&d.value===k||(H(),$e(()=>{d.value=k,y.value=X(k)||[],u.value=D,y.value.length&&$e(()=>{o.value&&o.value.handleOpen()})}))},E=k=>{if(e.contextMenus!=null){if(k.e.preventDefault(),k.e.stopPropagation(),u.value!==k.triggerEl){ae(k.item,k.triggerEl);return}y.value.length&&o.value&&o.value.handleOpen()}},B=k=>{if(!e.boxChoose||e.selectionType!=="checkbox")return;const D=k.clientX,G=k.clientY,F=k.currentTarget,ee=F.getBoundingClientRect(),de=Array.from(F.querySelectorAll(En)),ce=qt(ne=>{const V=Math.max(ne.clientX,ee.left),q=Math.max(ne.clientY,ee.top),T=Math.min(V,D)-ee.left,r=Math.min(q,G)-ee.top,m=Math.min(Math.abs(V-D),F.clientWidth-T),S=Math.min(Math.abs(q-G),F.clientHeight-r);if(n.left=T+"px",n.top=r+"px",n.width=m+"px",n.height=S+"px",n.display="block",m<6||S<6){de.forEach($=>{$.classList.remove("is-active")});return}k.stopPropagation(),k.preventDefault(),ne.stopPropagation(),ne.preventDefault(),de.forEach($=>{const R=$.offsetLeft+$.clientWidth,z=$.offsetTop+$.clientHeight;R>T&&z>r&&$.offsetLeft<T+m&&$.offsetTop<r+S?$.classList.add("is-active"):$.classList.remove("is-active")})},60),me=ne=>{n.display="none";const V=Math.max(ne.clientX,ee.left),q=Math.max(ne.clientY,ee.top),T=Math.min(V,D)-ee.left,r=Math.min(q,G)-ee.top,m=Math.min(Math.abs(V-D),F.clientWidth-T),S=Math.min(Math.abs(q-G),F.clientHeight-r);if(m>6&&S>6){const $=[];de.forEach((R,z)=>{R.classList.contains("is-active")&&(R.classList.remove("is-active"),e.data&&e.data[z]&&$.push(e.data[z]))}),$.length&&p($)}document.removeEventListener("mousemove",ce),document.removeEventListener("mouseup",me)};document.addEventListener("mousemove",ce),document.addEventListener("mouseup",me)};return be([()=>e.grid,()=>e.data],()=>{H(),u.value=null,d.value=null},{deep:!0}),rt(()=>{d.value=null}),{lang:s,selectorStyle:n,ctxMenuDropdownRef:o,ctxMenuDropdownItems:y,ctxMenuDropdownVirtualRef:u,ctxMenuDropdownVisible:i,contextMenuFileItem:d,isCheckAll:l,isIndeterminate:I,handleCheckAllChange:a,handleItemCheckChange:c,handleItemClick:h,handleSortChange:O,handleItemContextMenu:P,handleItemCtxMenuClick:x,handleItemCtxMenuVisible:W,handleItemContextOpen:E,handleMousedown:B}}}),Tn=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s};function Mn(e,t,s,n,o,y){const u=K("FileGrid"),i=K("FileTable"),d=K("EleDropdown");return g(),L("div",{class:"ele-file-list-group",onMousedown:t[0]||(t[0]=(...l)=>e.handleMousedown&&e.handleMousedown(...l))},[e.grid?(g(),Q(u,{key:0,data:e.data,icons:e.icons,selectionType:e.selectionType,selections:e.selections,current:e.current,isCheckAll:e.isCheckAll,isIndeterminate:e.isIndeterminate,checkAllText:e.lang.selectAll,selectedText:e.lang.selectTips,ctxMenuDropdownVisible:e.ctxMenuDropdownVisible,contextMenuFileItem:e.contextMenuFileItem,onCheckAllChange:e.handleCheckAllChange,onItemClick:e.handleItemClick,onItemCheckChange:e.handleItemCheckChange,onItemContextOpen:e.handleItemContextOpen},Te({_:2},[ye(Object.keys(e.$slots),l=>({name:l,fn:C(I=>[J(e.$slots,l,je(Ne(I||{})))])}))]),1032,["data","icons","selectionType","selections","current","isCheckAll","isIndeterminate","checkAllText","selectedText","ctxMenuDropdownVisible","contextMenuFileItem","onCheckAllChange","onItemClick","onItemCheckChange","onItemContextOpen"])):(g(),Q(i,{key:1,data:e.data,icons:e.icons,selectionType:e.selectionType,selections:e.selections,current:e.current,isCheckAll:e.isCheckAll,isIndeterminate:e.isIndeterminate,nameText:e.lang.fileName,sizeText:e.lang.fileSize,timeText:e.lang.fileTimestamp,sortable:e.sortable,sort:e.sort,order:e.order,columns:e.columns,ctxMenuDropdownVisible:e.ctxMenuDropdownVisible,contextMenuFileItem:e.contextMenuFileItem,onCheckAllChange:e.handleCheckAllChange,onItemClick:e.handleItemClick,onItemCheckChange:e.handleItemCheckChange,onItemContextOpen:e.handleItemContextOpen,onSortChange:e.handleSortChange},Te({_:2},[ye(Object.keys(e.$slots),l=>({name:l,fn:C(I=>[J(e.$slots,l,je(Ne(I||{})))])}))]),1032,["data","icons","selectionType","selections","current","isCheckAll","isIndeterminate","nameText","sizeText","timeText","sortable","sort","order","columns","ctxMenuDropdownVisible","contextMenuFileItem","onCheckAllChange","onItemClick","onItemCheckChange","onItemContextOpen","onSortChange"])),b("div",{class:"ele-file-list-selector",style:ke(e.selectorStyle)},null,4),e.contextMenus?(g(),Q(d,le({key:2,persistent:!1,placement:"bottom-start",popperClass:"ele-file-list-item-context"},e.contextMenuProps||{},{ref:"ctxMenuDropdownRef",componentType:"pro",preventContextmenu:!0,trigger:"click",virtualTriggering:!0,virtualRef:e.ctxMenuDropdownVirtualRef,disabled:!e.ctxMenuDropdownItems.length,items:e.ctxMenuDropdownItems,onCommand:e.handleItemCtxMenuClick,onVisibleChange:e.handleItemCtxMenuVisible}),null,16,["virtualRef","disabled","items","onCommand","onVisibleChange"])):N("",!0)],32)}const On=Tn(Vn,[["render",Mn]]),Pn={...ht,teleported:{type:Boolean,default:!0},modelValue:Boolean,customClass:String,customStyle:Object,transitionName:{type:String,default:"ele-image-viewer-fade"},keepAlive:Boolean},Ln={"update:modelValue":e=>!0,close:()=>!0,switch:e=>!0,rotate:e=>!0},Dn=te({name:"EleImageViewer",components:{ElImageViewer:yt},props:Pn,emits:Ln,setup(e,{emit:t}){const s=_(null),n=j(()=>{const i=Wt(e,["modelValue","customClass","customStyle","transitionName","keepAlive"]);return i.teleported=!1,i}),o=()=>{t("update:modelValue",!1),t("close")},y=i=>{t("switch",i)},u=i=>{t("rotate",i)};return Yt(()=>{o()}),{imageViewerRef:s,viewerProps:n,handleClose:o,handleSwitch:y,handleRotate:u}}}),Rn=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s};function Fn(e,t,s,n,o,y){const u=K("ElImageViewer");return g(),Q(Xt,{to:"body",disabled:!e.teleported},[v(tt,{name:e.transitionName,appear:!0},{default:C(()=>[e.modelValue?(g(),L("div",{key:0,class:Y(["ele-image-viewer",e.customClass]),style:ke(e.customStyle)},[v(u,le(e.viewerProps,{ref:"imageViewerRef",onClose:e.handleClose,onSwitch:e.handleSwitch,onRotate:e.handleRotate}),{default:C(()=>[J(e.$slots,"default")]),_:3},16,["onClose","onSwitch","onRotate"])],6)):N("",!0)]),_:3},8,["name"])],8,["disabled"])}const An=Rn(Dn,[["render",Fn]]),zn={modelValue:[String,Number],block:Boolean,disabled:Boolean,items:{type:Array,required:!0},size:String},xn={"update:modelValue":e=>!0,change:e=>!0},Bn=te({name:"EleSegmented",components:{ElIcon:pe,ElTabs:Kt,ElTabPane:Ht},props:zn,emits:xn,setup(e,{emit:t}){const{validateChange:s}=Qt(),n=_(null),o=j(()=>e.modelValue==null||!e.items||!e.items.some(d=>d.value===e.modelValue)),y=d=>{e.modelValue!==d&&(t("update:modelValue",d),s(),t("change",d))},u=()=>{const d=n.value?n.value.$el:void 0,l=d?d.querySelector(".el-tabs__header"):void 0;return l?l.querySelector(".el-tabs__nav"):void 0};return{tabRef:n,isEmptyActive:o,handleUpdateModelValue:y,updateActiveBar:()=>{const d=u();if(d){const l=d.querySelector(".el-tabs__active-bar");l&&(l.style.width="0px")}}}}}),Un=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s},jn={key:1,class:"ele-segmented-item-label"};function Nn(e,t,s,n,o,y){const u=K("ElIcon"),i=K("ElTabPane"),d=K("ElTabs");return g(),Q(d,{ref:"tabRef",modelValue:e.modelValue,stretch:e.block,class:Y(["ele-segmented",{"is-block":e.block},{"is-large":e.size==="large"},{"is-small":e.size==="small"},{"is-disabled":e.disabled},{"is-single":e.items&&e.items.length===1},{"is-empty":e.isEmptyActive}]),"onUpdate:modelValue":e.handleUpdateModelValue},{default:C(()=>[(g(!0),L(re,null,ye(e.items,(l,I)=>(g(),Q(i,{key:I+"-"+l.value+"-"+l.label,name:l.value,disabled:e.disabled||l.disabled},{label:C(()=>[J(e.$slots,"label",{item:l},()=>[l.icon?(g(),Q(u,le({key:0,ref_for:!0},l.iconProps||{},{class:"ele-segmented-item-icon"}),{default:C(()=>[(g(),Q(lt(l.icon),{style:ke(l.iconStyle)},null,8,["style"]))]),_:2},1040)):N("",!0),l.label?(g(),L("div",jn,oe(l.label),1)):N("",!0)])]),_:2},1032,["name","disabled"]))),128))]),_:3},8,["modelValue","stretch","class","onUpdate:modelValue"])}const Gn=Un(Bn,[["render",Nn]]),qn=te({name:"ListItem",components:{CloseOutlined:Zt,EyeOutlined:Jt,EditOutlined:qe,SyncOutlined:el,FileOutlined:tl,ElImage:Rl,ElProgress:Il,ElIcon:pe},props:{item:{type:Object,required:!0},readonly:Boolean,disabled:Boolean,sortable:Boolean,imageProps:Object,progressProps:Object,imageObjectUrls:Array,tools:Boolean,listType:String,locale:{type:Object,required:!0}},emits:{itemClick:e=>!0,remove:e=>!0,edit:e=>!0,preview:e=>!0,retry:e=>!0},setup(e,{emit:t}){const s=j(()=>{var l;if(e.item.url)return e.item.url;if(!(!e.item.file||!e.imageObjectUrls))return(l=e.imageObjectUrls.find(I=>I.file===e.item.file))==null?void 0:l.url}),n=j(()=>{const l=e.item.progress;return!l||l<0?0:l>100?100:l});return{imageUrl:s,uploadProgress:n,handleItemClick:()=>{t("itemClick",e.item)},handleRemove:()=>{t("remove",e.item)},handleEdit:()=>{t("edit",e.item)},handlePreview:()=>{t("preview",e.item)},handleRetry:()=>{t("retry",e.item)}}}}),Wn=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s},Yn=["title"],Xn={key:0,class:"ele-upload-thumbnail"},Kn={class:"ele-upload-thumbnail-text"},Hn={key:0,class:"ele-upload-progress"},Qn={class:"ele-upload-text"},Zn=["title"],Jn={class:"ele-upload-tool-text"},eo={key:1,class:"ele-upload-tools"},to=["title"],lo={class:"ele-upload-tool-text"},no=["title"],oo={class:"ele-upload-tool-text"},so=["title"],ao={key:3,class:"ele-upload-handle"};function io(e,t,s,n,o,y){const u=K("FileOutlined"),i=K("ElIcon"),d=K("ElImage"),l=K("ElProgress"),I=K("SyncOutlined"),p=K("EyeOutlined"),f=K("EditOutlined"),a=K("CloseOutlined");return g(),L("div",{title:e.item.name,class:"ele-upload-item",onClick:t[4]||(t[4]=(...c)=>e.handleItemClick&&e.handleItemClick(...c))},[J(e.$slots,"thumbnail",{item:e.item,imageUrl:e.imageUrl},()=>[e.listType==="file"||!e.imageUrl?(g(),L("div",Xn,[v(i,{class:"ele-upload-thumbnail-icon"},{default:C(()=>[v(u)]),_:1}),b("div",Kn,oe(e.item.name||e.item.url),1)])):(g(),Q(d,le({key:1,fit:"contain",class:"ele-upload-image"},e.imageProps||{},{src:e.imageUrl}),null,16,["src"]))]),e.item.status==="uploading"||e.item.status==="exception"?(g(),L("div",Hn,[J(e.$slots,"progress",{item:e.item},()=>[b("div",Qn,oe(e.item.status=="exception"?e.locale.exception:e.locale.uploading),1),v(l,le({showText:!1,strokeWidth:e.listType==="file"?2:void 0,status:e.item.status==="exception"?"exception":void 0,class:"ele-upload-progress-bar"},e.progressProps||{},{percentage:e.uploadProgress}),null,16,["strokeWidth","status","percentage"]),!e.disabled&&e.item.status==="exception"?(g(),L("div",{key:0,title:e.locale.retry,class:"ele-upload-tool ele-upload-retry",onClick:t[0]||(t[0]=se((...c)=>e.handleRetry&&e.handleRetry(...c),["stop"]))},[v(i,{class:"ele-upload-tool-icon"},{default:C(()=>[v(I)]),_:1}),b("div",Jn,oe(e.locale.retry),1)],8,Zn)):N("",!0)])])):e.tools&&!e.readonly&&!e.disabled&&!e.item.readonly?(g(),L("div",eo,[b("div",{title:e.locale.preview,class:"ele-upload-tool",onClick:t[1]||(t[1]=se((...c)=>e.handlePreview&&e.handlePreview(...c),["stop"]))},[v(i,{class:"ele-upload-tool-icon"},{default:C(()=>[v(p)]),_:1}),b("div",lo,oe(e.locale.preview),1)],8,to),b("div",{title:e.locale.edit,class:"ele-upload-tool",onClick:t[2]||(t[2]=se((...c)=>e.handleEdit&&e.handleEdit(...c),["stop"]))},[v(i,{class:"ele-upload-tool-icon"},{default:C(()=>[v(f)]),_:1}),b("div",oo,oe(e.locale.edit),1)],8,no)])):N("",!0),!e.readonly&&!e.disabled&&!e.item.readonly?(g(),L("div",{key:2,title:e.locale.remove,class:"ele-upload-tool ele-upload-remove",onClick:t[3]||(t[3]=se((...c)=>e.handleRemove&&e.handleRemove(...c),["stop"]))},[J(e.$slots,"remove",{item:e.item},()=>[v(i,{class:"ele-upload-tool-icon"},{default:C(()=>[v(a)]),_:1})])],8,so)):N("",!0),e.sortable?(g(),L("div",ao)):N("",!0)],8,Yn)}const ro=Wn(qn,[["render",io]]),uo={modelValue:Array,readonly:Boolean,disabled:Boolean,preview:{type:Boolean,default:!0},limit:Number,multiple:Boolean,drag:Boolean,accept:{type:String,default:"image/png,image/jpeg"},itemStyle:[Object,Boolean],buttonStyle:{type:[Object,Boolean],default:null},sortable:{type:[Boolean,Object],default:!0},imageProps:Object,progressProps:Object,previewProps:Object,tools:Boolean,listType:String,beforeUploadClick:Function,beforeItemEdit:Function,locale:Object},co={"update:modelValue":e=>!0,itemClick:e=>!0,upload:e=>!0,remove:e=>!0,retry:e=>!0,editUpload:e=>!0,preview:e=>!0},mo=["default","icon"],fo=te({name:"EleUploadList",components:{VueDraggable:wl,ElUpload:gt,ElIcon:pe,PlusOutlined:ll,EleImageViewer:An,ListItem:ro},props:uo,emits:co,setup(e,{emit:t}){const{lang:s}=it("upload",e),n=_(!1),o=_([]),y=_(0),u=_([]),i=_(null);let d=null;const l=j(()=>!e.readonly&&!(typeof e.limit=="number"&&e.limit>0&&e.modelValue!=null&&e.modelValue.length>=e.limit)),I=E=>({key:"ele"+nl(16,10)+String(Date.now()),name:E.name,status:void 0,progress:0,file:E}),p=(E,B)=>{if(E&&E.url)return E.url;const k=E==null?void 0:E.file;if(k!=null&&k.type.startsWith("image")){const D=u.value.find(F=>F.file===k);if(D!=null)return D.url;const G=URL.createObjectURL(k);return u.value.push({file:k,url:G}),G}},f=E=>{if(e.modelValue!=null){const B=[];e.modelValue.forEach(D=>{const G=p(D);G&&B.push({item:D,url:G})});const k=B.findIndex(D=>D.item.key===E.key);if(k!==-1){const D=B.map(G=>G.url);a(D,k)}}},a=(E,B)=>{o.value=E,y.value=B,n.value=!0},c=E=>{t("update:modelValue",E)},h=E=>{if(l.value&&!e.disabled){const B=I(E);t("upload",B)}return!1},O=E=>{e.preview&&f(E),t("itemClick",E)},P=E=>{t("remove",E)},x=E=>{if(e.beforeItemEdit&&e.beforeItemEdit(E)===!1)return;const B=i.value;B!=null&&(d=E,B.value="",B&&B.click())},W=E=>{f(E),t("preview",E)},X=E=>{t("retry",E)},H=E=>{var B;const k=(B=E.target.files)==null?void 0:B[0];if(k!=null&&d!=null){const D={item:d,newItem:I(k)};d=null,t("editUpload",D)}},ae=E=>{e.beforeUploadClick&&e.beforeUploadClick(E)===!1&&(E.stopPropagation(),E.preventDefault())};return be(()=>e.modelValue,()=>{e.modelValue!=null&&e.modelValue.forEach(E=>{p(E)})},{immediate:!0,deep:!0}),rt(()=>{u.value.forEach(E=>{URL.revokeObjectURL(E.url)}),u.value=[]}),{ownSlots:mo,lang:s,previewVisible:n,previewImages:o,previewCurrentIndex:y,imageObjectUrls:u,uploadInputRef:i,uploadEnable:l,updateModelValue:c,handleUpload:h,handleItemClick:O,handleItemRemove:P,handleItemEdit:x,handleItemPreview:W,handleItemRetry:X,handleInputChange:H,handleUploadClick:ae,openImagePreview:a}}}),po=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s},vo=["accept"];function go(e,t,s,n,o,y){const u=K("ListItem"),i=K("PlusOutlined"),d=K("ElIcon"),l=K("ElUpload"),I=K("EleImageViewer"),p=K("VueDraggable");return g(),Q(p,le({itemKey:"key",animation:300,setData:()=>{},handle:".ele-upload-handle",class:["ele-upload-list",{"is-file-list":e.listType==="file"},{"is-disabled":e.disabled}]},!e.sortable||e.sortable===!0?{}:e.sortable,{modelValue:e.modelValue||[],"onUpdate:modelValue":e.updateModelValue}),{item:C(({element:f})=>[v(u,{item:f,readonly:e.readonly,disabled:e.disabled,sortable:e.sortable&&!e.readonly&&!e.disabled&&e.limit!==1,imageProps:e.imageProps,progressProps:e.progressProps,imageObjectUrls:e.imageObjectUrls,tools:e.tools,listType:e.listType,locale:e.lang,style:ke(e.itemStyle),onItemClick:e.handleItemClick,onRemove:e.handleItemRemove,onEdit:e.handleItemEdit,onPreview:e.handleItemPreview,onRetry:e.handleItemRetry},Te({_:2},[ye(Object.keys(e.$slots).filter(a=>!e.ownSlots.includes(a)),a=>({name:a,fn:C(c=>[J(e.$slots,a,je(Ne(c||{})))])}))]),1032,["item","readonly","disabled","sortable","imageProps","progressProps","imageObjectUrls","tools","listType","locale","style","onItemClick","onRemove","onEdit","onPreview","onRetry"])]),footer:C(()=>[e.uploadEnable&&e.buttonStyle!==!1?(g(),L("div",{key:0,style:ke(typeof e.buttonStyle=="boolean"?void 0:e.buttonStyle),class:"ele-upload-item ele-upload-button"},[v(l,{action:"",drag:e.drag,accept:e.accept,multiple:e.multiple,disabled:e.disabled,showFileList:!1,beforeUpload:e.handleUpload},{default:C(()=>[b("div",{class:"ele-upload-button-inner",onClick:t[0]||(t[0]=(...f)=>e.handleUploadClick&&e.handleUploadClick(...f))},[J(e.$slots,"icon",{},()=>[v(d,{class:"ele-upload-icon"},{default:C(()=>[v(i)]),_:1})])])]),_:3},8,["drag","accept","multiple","disabled","beforeUpload"])],4)):N("",!0),e.tools?(g(),L("input",{key:1,ref:"uploadInputRef",type:"file",accept:e.accept,class:"ele-upload-input",onChange:t[1]||(t[1]=(...f)=>e.handleInputChange&&e.handleInputChange(...f))},null,40,vo)):N("",!0),v(I,le({infinite:!1},e.previewProps||{},{modelValue:e.previewVisible,"onUpdate:modelValue":t[2]||(t[2]=f=>e.previewVisible=f),urlList:e.previewImages,initialIndex:e.previewCurrentIndex}),null,16,["modelValue","urlList","initialIndex"])]),_:3},16,["class","modelValue","onUpdate:modelValue"])}const ho=po(fo,[["render",go]]),ze="/ele-file-list/ic_file_folder.png",yo=b("img",{src:ze,class:"file-picker-tree-icon"},null,-1),ko=["title"],Co=te({__name:"file-group",props:{groupData:{}},emits:["groupSelect","addBtnClick","moreIconClick","hideGroupCtxMenu"],setup(e,{expose:t,emit:s}){const n=s,o=_(null),y=I=>{n("groupSelect",I,!0)},u=()=>{n("addBtnClick")},i=(I,p)=>{n("moreIconClick",I.currentTarget,p)},d=(I,p)=>{var a,c;if(p.id===0||p.id===-1){n("hideGroupCtxMenu");return}const f=(c=(a=sl(I.currentTarget,"el-tree-node__content"))==null?void 0:a.querySelector)==null?void 0:c.call(a,".file-picker-tree-more");f&&f.click()};return t({setSelectedGroup:I=>{var p,f;(f=(p=o.value)==null?void 0:p.setCurrentKey)==null||f.call(p,I.id)}}),(I,p)=>{const f=pe,a=vt,c=pt;return g(),L(re,null,[v(a,{ref_key:"treeRef",ref:o,data:I.groupData,highlightCurrent:!0,nodeKey:"id",props:{label:"name"},expandOnClickNode:!1,defaultExpandAll:!0,class:"file-picker-left",onNodeClick:y,onNodeContextmenu:d},{default:C(h=>[yo,b("span",{class:"el-tree-node__label",title:h.data.name},oe(h.data.name),9,ko),h.data.id!==0&&h.data.id!==-1?(g(),Q(f,{key:0,class:"file-picker-tree-more",onClick:se(O=>i(O,h.data),["stop"])},{default:C(()=>[v(w(ol),{style:{transform:"scale(1.1)"}})]),_:2},1032,["onClick"])):N("",!0)]),_:1},8,["data"]),v(c,{type:"primary",underline:!1,class:"file-picker-left-add",onClick:u},{default:C(()=>[ue(" 添加分组")]),_:1})],64)}}});async function os(e,t,s,n){const o=new FormData;return o.append("category",e),o.append("file",t,s),await _e.Post("/file/upload",o,{...n,meta:{postType:ut.FORM_DATA}})}async function bo(e,t,s,n){const o=new FormData;return o.append("parentId",e.toString()),o.append("file",t,s),await _e.Post("/file/uploadById",o,{...n,meta:{postType:ut.FORM_DATA}})}async function Io(e){const t=await _e.Post("/file/pageList",e);return t.code===0&&t.data?t.data:Promise.reject(new Error(t.message))}async function wo(e){const t=await _e.Post("/file/list",e);return t.code===0&&t.data?t.data:Promise.reject(new Error(t.message))}async function _o(e){const t=await _e.Post("/file",e);return t.code===0?t.message:Promise.reject(new Error(t.message))}async function kt(e){const t=await _e.Put("/system/user-file",e);return t.code===0?t.message:Promise.reject(new Error(t.message))}async function $o(e){const t=await _e.Delete("/system/user-file/"+e);return t.code===0?t.message:Promise.reject(new Error(t.message))}async function ss(e){const t=await _e.Delete("/system/user-file/batch",{data:e});return t.code===0?t.message:Promise.reject(new Error(t.message))}const So={class:"file-picker-right"},Eo={class:"file-picker-right-header"},Vo={class:"file-picker-right-title"},To=b("span",null,"已选择 ",-1),Mo=b("span",null," / ",-1),Oo={key:1},Po=te({__name:"file-selections",props:{fileSelections:{},limit:{},selectionListProps:{},baseIndex:{}},emits:["clearSelections","removeItem"],setup(e,{expose:t,emit:s}){const n=e,o=s,{mobileDevice:y}=al(),u=_(null),i=_([]),d=Ge({zIndex:n.baseIndex}),l=a=>{const c=n.fileSelections.find(h=>h.key===a.key);c&&o("removeItem",c)},I=()=>{o("clearSelections")},p=()=>{const a=[];return i.value.forEach(c=>{const h=n.fileSelections.find(O=>O.key===c.key);h&&a.push(h)}),a},f=(a,c)=>{u.value&&u.value.openImagePreview(a,c)};return be(()=>n.fileSelections,a=>{if(!a||!a.length){i.value.length&&(i.value=[]);return}const c=i.value.filter(h=>a.some(O=>O.key===h.key));a.forEach(h=>{c.some(O=>O.key===h.key)||c.push({key:h.key,name:h.name,url:h.thumbnail,status:"done"})}),il(i.value.map(h=>h.key),c.map(h=>h.key),!0)&&(i.value=c)},{immediate:!0,deep:!0}),be(()=>n.baseIndex,a=>{d.zIndex=a}),t({getSelections:p,openImagePreview:f}),(a,c)=>{const h=pt,O=ho;return g(),L("div",So,[b("div",Eo,[b("div",Vo,[To,b("span",null,oe(a.fileSelections.length),1),a.limit?(g(),L(re,{key:0},[Mo,b("span",null,oe(a.limit),1)],64)):(g(),L("span",Oo," 个"))]),v(h,{type:"danger",underline:!1,class:"file-picker-right-clear",onClick:I},{default:C(()=>[ue(" 清空 ")]),_:1})]),v(O,le({limit:a.limit,previewProps:d},a.selectionListProps||{},{ref_key:"uploadListRef",ref:u,modelValue:i.value,"onUpdate:modelValue":c[0]||(c[0]=P=>i.value=P),buttonStyle:!1,sortable:!w(y),onRemove:l}),null,16,["limit","previewProps","modelValue","sortable"])])}}}),Lo={class:"file-picker-main"},Do={class:"file-picker-body"},Ro={class:"file-picker-toolbar"},Fo={class:"file-picker-search"},Ao=te({__name:"file-list",props:{limit:{},fileLimit:{},accept:{},parentId:{},params:{},fileListProps:{},selectionListProps:{},emptyProps:{},paginationProps:{},baseIndex:{},messageIns:{}},emits:["queryStart","queryDone","renameFile","moveFile","removeFile","fileItemContextOpen"],setup(e,{expose:t,emit:s}){const n=e,o=s,y=_(),u=_([]),i=_([]),d=_(),l=_(1),I=_(""),p=_(1),f=_(24),a=_(0),c=_(!1),h=[{icon:ul,value:0,iconStyle:{transform:"scale(0.9)"}},{icon:cl,value:1}],O=_(),P=Ge({menuStyle:{minWidth:"120px"},iconProps:{size:15},popperOptions:{strategy:"fixed"},zIndex:n.baseIndex}),x=(r,m)=>{var S,$;if(n.limit&&n.limit>1&&(m?r.length>=n.limit:r.length>n.limit))return($=(S=n.messageIns)==null?void 0:S.error)==null||$.call(S,`最多只能选择 ${n.limit} 个`),!1},W=r=>{if(x(r)!==!1){i.value=r;return}n.limit&&n.limit>1&&(i.value=r.slice(0,n.limit))},X=()=>{i.value=[],d.value=void 0},H=()=>O.value?(O.value.getSelections()||[]).map(m=>m.userFile):[],ae=r=>{if(n.limit===1){X();return}const m=i.value.findIndex(S=>S.key===r.key);m!==-1&&i.value.splice(m,1)},E=()=>{T({page:1})},B=r=>{p.value!==r&&(p.value=r,T())},k=r=>{if(f.value!==r){p.value=1,f.value=r;const m=Math.ceil(a.value/r);m&&p.value>m&&(p.value=m),T()}},D=r=>{if(n.limit===1){d.value=r;return}const m=i.value.findIndex(S=>S.key===r.key);if(m!==-1){i.value.splice(m,1);return}x(i.value,!0)!==!1&&i.value.push(r)},G=r=>{const{key:m,item:S}=r,$=S.userFile;if(m==="preview"){if(!S.thumbnail){window.open(S.url);return}const R=u.value.filter(ie=>!!ie.thumbnail),z=R.map(ie=>ie.url),A=R.indexOf(S);A!==-1&&O.value&&O.value.openImagePreview(z,A)}else m==="rename"?o("renameFile",$,!0):m==="move"?o("moveFile",$,!0):m==="remove"&&o("removeFile",$,!0)},F=r=>{const m=[{title:"重命名",command:"rename",icon:Ie(qe)},{title:"移动到",command:"move",icon:Ie(dl)},{title:"删除",command:"remove",icon:Ie(ct),divided:!0,danger:!0}];return r.thumbnail?(m[0].divided=!0,m.unshift({title:"预览",command:"preview"})):(m[0].divided=!0,m.unshift({title:"打开",command:"preview"})),m},ee=()=>{o("fileItemContextOpen")},de=r=>{var m,S,$,R,z,A;if(r){if(n.accept==="image/*"){if(!r.type.startsWith("image")){(S=(m=n.messageIns)==null?void 0:m.error)==null||S.call(m,"只能选择图片");return}}else if(n.accept===".xls,.xlsx"&&!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(r.type)){(R=($=n.messageIns)==null?void 0:$.error)==null||R.call($,"只能选择 excel 文件");return}if(n.fileLimit&&r.size/1024/1024>n.fileLimit){(A=(z=n.messageIns)==null?void 0:z.error)==null||A.call(z,`大小不能超过 ${n.fileLimit}MB`);return}return!0}},ce=r=>{var m,S;if(de(r)){const $=(S=(m=n.messageIns)==null?void 0:m.loading)==null?void 0:S.call(m,{message:"上传中..",plain:!0,mask:!0});bo(n.parentId||0,r,r.name).then(()=>{var R,z,A;(R=$==null?void 0:$.close)==null||R.call($),(A=(z=n.messageIns)==null?void 0:z.success)==null||A.call(z,"上传成功"),T()}).catch(R=>{var z,A,ie;(z=$==null?void 0:$.close)==null||z.call($),(ie=(A=n.messageIns)==null?void 0:A.error)==null||ie.call(A,R.message)})}return!1},me=r=>{const S=r.currentTarget.scrollTop;c.value=S>1},ne=()=>{o("queryDone")},V=r=>r.contentType?/(png|jpe?g|gif)$/i.test(r.contentType.toLowerCase())&&r.url:!1,q=r=>r==null?"-":r<1024?r+"B":r<1024*1024?(r/1024).toFixed(1)+"KB":r<1024*1024*1024?(r/1024/1024).toFixed(1)+"M":(r/1024/1024/1024).toFixed(1)+"G",T=r=>{o("queryStart"),r&&(r.page!=null&&(p.value=r.page),r.parentId!=null&&(y.value=r.parentId),r.name!=null&&(I.value=r.name));const m=y.value;Io({page:p.value,limit:f.value,parentId:m===-1?void 0:m,name:I.value,isDirectory:0,...n.params||{}}).then(S=>{var $,R,z;if(!(($=S==null?void 0:S.list)!=null&&$.length)&&(S!=null&&S.count)){const A=Math.ceil(S.count/f.value);if(A&&p.value>A){T({page:A});return}}a.value=(S==null?void 0:S.count)||0,u.value=((z=(R=S==null?void 0:S.list)==null?void 0:R.map)==null?void 0:z.call(R,A=>({key:A.id,name:A.name,url:A.url,thumbnail:V(A)?A.thumbnail:void 0,length:q(A.length),updateTime:A.updateTime,isDirectory:A.isDirectory===1,userFile:A})))||[],console.log(u.value),ne()}).catch(S=>{var $,R;u.value=[],(R=($=n.messageIns)==null?void 0:$.error)==null||R.call($,S.message),ne()})};return be(()=>n.limit,()=>{X()}),be(()=>n.baseIndex,r=>{P.zIndex=r}),t({queryData:T,clearSelections:X,getSelections:H}),(r,m)=>{const S=De,$=gt,R=We,z=Gn,A=On,ie=bl,Se=Cl;return g(),L("div",Lo,[b("div",Do,[b("div",Ro,[v($,{action:"",accept:r.accept,showFileList:!0,beforeUpload:ce},{default:C(()=>[v(S,{type:"primary",class:"ele-btn-icon",icon:w(rl)},{default:C(()=>[ue(" 上传")]),_:1},8,["icon"])]),_:1},8,["accept"]),b("div",Fo,[v(R,{clearable:!0,modelValue:I.value,"onUpdate:modelValue":m[0]||(m[0]=ve=>I.value=ve),placeholder:"请输入文件名",onClear:E,onChange:E},null,8,["modelValue"]),v(S,{type:"primary",onClick:E},{default:C(()=>[ue("搜索")]),_:1})]),v(z,{modelValue:l.value,"onUpdate:modelValue":m[1]||(m[1]=ve=>l.value=ve),items:h},null,8,["modelValue"])]),u.value.length?(g(),L(re,{key:0},[b("div",{class:"file-picker-file-list",onScroll:me},[v(A,le({boxChoose:!0,icons:w(In),smallIcons:w(Ye),contextMenuProps:P},r.fileListProps||{},{data:u.value,grid:l.value===1,selectionType:r.limit===1?"radio":"checkbox",selections:i.value,current:d.value,"onUpdate:current":m[2]||(m[2]=ve=>d.value=ve),contextMenus:F,class:[{"is-ping-top":c.value}],onItemClick:D,onItemContextMenu:G,"onUpdate:selections":W,onItemContextOpen:ee}),null,16,["icons","smallIcons","contextMenuProps","data","grid","selectionType","selections","current","class"])],32),v(ie,le({size:"small",teleported:!1,pageSizes:[18,24,30,36,42],layout:"total,prev,pager,next,sizes"},r.paginationProps||{},{currentPage:p.value,pageSize:f.value,total:a.value,"onUpdate:currentPage":B,"onUpdate:pageSize":k}),null,16,["currentPage","pageSize","total"])],64)):(g(),Q(Se,le({key:1,imageSize:80,description:"无数据"},r.emptyProps||{}),null,16))]),v(Po,{ref_key:"fileSelectionsRef",ref:O,fileSelections:r.limit===1?d.value?[d.value]:[]:i.value,limit:r.limit,selectionListProps:r.selectionListProps,baseIndex:r.baseIndex,onClearSelections:X,onRemoveItem:ae},null,8,["fileSelections","limit","selectionListProps","baseIndex"])])}}}),zo=b("img",{src:ze,class:"file-picker-tree-icon"},null,-1),xo=b("img",{src:ze,class:"file-picker-tree-icon"},null,-1),Bo=te({__name:"file-group-add",props:we({parentId:{},groupData:{},modalProps:{},baseIndex:{},messageIns:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:we(["done"],["update:modelValue"]),setup(e,{emit:t}){const s=e,n=t,o=Fe(e,"modelValue"),y=_(null),u=_(!1),[i,d]=dt({name:"",parentId:void 0}),l=()=>{o.value=!1},I=()=>{var a,c;(c=(a=y.value)==null?void 0:a.validate)==null||c.call(a,h=>{h&&(u.value=!0,_o({...i,isDirectory:1}).then(O=>{var P,x;u.value=!1,(x=(P=s.messageIns)==null?void 0:P.success)==null||x.call(P,O),l(),n("done")}).catch(O=>{var P,x;u.value=!1,(x=(P=s.messageIns)==null?void 0:P.error)==null||x.call(P,O.message)}))})},p=()=>{var a,c;d(),(c=(a=y.value)==null?void 0:a.clearValidate)==null||c.call(a)},f=()=>{s.parentId!=null&&(i.parentId=s.parentId)};return(a,c)=>{const h=_l,O=mt,P=We,x=ft,W=De,X=Ae;return g(),Q(X,le({form:!0,width:460,title:"添加分组",zIndex:a.baseIndex,appendToBody:!1},a.modalProps||{},{modelValue:o.value,"onUpdate:modelValue":c[3]||(c[3]=H=>o.value=H),onOpen:f,onClosed:p}),{footer:C(()=>[v(W,{onClick:l},{default:C(()=>[ue("取消")]),_:1}),v(W,{type:"primary",loading:u.value,onClick:I},{default:C(()=>[ue(" 保存 ")]),_:1},8,["loading"])]),default:C(()=>[v(x,{ref_key:"formRef",ref:y,model:w(i),labelWidth:"82px",onSubmit:c[2]||(c[2]=se(()=>{},["prevent"]))},{default:C(()=>[v(O,{label:"上级分组",prop:"parentId"},{default:C(()=>[v(h,{modelValue:w(i).parentId,"onUpdate:modelValue":c[0]||(c[0]=H=>w(i).parentId=H),data:a.groupData.filter(H=>H.id!==0&&H.id!==-1),nodeKey:"id",props:{label:"name"},clearable:!0,checkStrictly:!0,defaultExpandAll:!0,placeholder:"请选择上级分组",popperOptions:{strategy:"fixed"},teleported:!1,class:"ele-fluid"},Te({default:C(({data:H})=>[zo,b("span",null,oe(H.name),1)]),_:2},[w(i).parentId?{name:"prefix",fn:C(()=>[xo]),key:"0"}:void 0]),1032,["modelValue","data"])]),_:1}),v(O,{label:"分组名称",prop:"name",rules:[{required:!0,message:"请输入分组名称",type:"string",trigger:"blur"}]},{default:C(()=>[v(P,{maxlength:20,clearable:!0,modelValue:w(i).name,"onUpdate:modelValue":c[1]||(c[1]=H=>w(i).name=H),placeholder:"请输入分组名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},16,["zIndex","modelValue"])}}}),Uo=te({__name:"file-rename",props:we({data:{},modalProps:{},baseIndex:{},messageIns:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:we(["done"],["update:modelValue"]),setup(e,{emit:t}){const s=e,n=t,o=Fe(e,"modelValue"),y=_(null),u=_(!1),[i,d]=dt({name:""}),l=()=>{o.value=!1},I=()=>{var a,c;(c=(a=y.value)==null?void 0:a.validate)==null||c.call(a,h=>{var O;h&&(u.value=!0,kt({...i,id:(O=s.data)==null?void 0:O.id}).then(P=>{var x,W;u.value=!1,(W=(x=s.messageIns)==null?void 0:x.success)==null||W.call(x,P),l(),n("done")}).catch(P=>{var x,W;u.value=!1,(W=(x=s.messageIns)==null?void 0:x.error)==null||W.call(x,P.message)}))})},p=()=>{var a,c;d(),(c=(a=y.value)==null?void 0:a.clearValidate)==null||c.call(a)},f=()=>{s.data&&(i.name=s.data.name)};return(a,c)=>{const h=We,O=mt,P=ft,x=De,W=Ae;return g(),Q(W,le({form:!0,width:460,title:"重命名",zIndex:a.baseIndex,appendToBody:!1},a.modalProps||{},{modelValue:o.value,"onUpdate:modelValue":c[2]||(c[2]=X=>o.value=X),onOpen:f,onClosed:p}),{footer:C(()=>[v(x,{onClick:l},{default:C(()=>[ue("取消")]),_:1}),v(x,{type:"primary",loading:u.value,onClick:I},{default:C(()=>[ue(" 保存 ")]),_:1},8,["loading"])]),default:C(()=>[v(P,{ref_key:"formRef",ref:y,model:w(i),labelWidth:"82px",onSubmit:c[1]||(c[1]=se(()=>{},["prevent"]))},{default:C(()=>[v(O,{label:`${a.data&&a.data.isDirectory?"分组":"文件"}名称`,prop:"name",rules:[{required:!0,message:`请输入${a.data&&a.data.isDirectory?"分组":"文件"}名称`,type:"string",trigger:"blur"}]},{default:C(()=>[v(h,{maxlength:20,clearable:!0,modelValue:w(i).name,"onUpdate:modelValue":c[0]||(c[0]=X=>w(i).name=X),placeholder:`请输入${a.data&&a.data.isDirectory?"分组":"文件"}名称`},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},16,["zIndex","modelValue"])}}}),jo={class:"file-picker-move-wrapper"},No=b("img",{src:ze,class:"file-picker-tree-icon"},null,-1),Go=te({__name:"file-move",props:we({data:{},groupData:{},modalProps:{},baseIndex:{},messageIns:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:we(["done"],["update:modelValue"]),setup(e,{emit:t}){const s=e,n=t,o=Fe(e,"modelValue"),y=_(!1),u=_(),i=p=>{u.value=p.id},d=()=>{o.value=!1},l=()=>{var f,a,c;const p=u.value;if(p==null){(a=(f=s.messageIns)==null?void 0:f.error)==null||a.call(f,"请选择分组");return}y.value=!0,kt({id:(c=s.data)==null?void 0:c.id,parentId:p}).then(h=>{var O,P;y.value=!1,(P=(O=s.messageIns)==null?void 0:O.success)==null||P.call(O,h),d(),n("done")}).catch(h=>{var O,P;y.value=!1,(P=(O=s.messageIns)==null?void 0:O.error)==null||P.call(O,h.message)})},I=()=>{s.data&&(u.value=s.data.parentId)};return(p,f)=>{const a=ml,c=vt,h=De,O=Ae;return g(),Q(O,le({width:460,title:"移动到",zIndex:p.baseIndex,appendToBody:!1},p.modalProps||{},{modelValue:o.value,"onUpdate:modelValue":f[0]||(f[0]=P=>o.value=P),onOpen:I}),{footer:C(()=>[v(h,{onClick:d},{default:C(()=>[ue("取消")]),_:1}),v(h,{type:"primary",loading:y.value,onClick:l},{default:C(()=>[ue(" 保存 ")]),_:1},8,["loading"])]),default:C(()=>[b("div",jo,[v(c,{data:p.groupData.filter(P=>P.id!==-1),nodeKey:"id",props:{label:"name"},expandOnClickNode:!1,defaultExpandAll:!0,class:"file-picker-move-tree",onNodeClick:i},{default:C(P=>[No,b("span",{class:Y(["el-tree-node__label",{"is-active":P.data.id===u.value}])},oe(P.data.name),3),v(a,{value:!0,modelValue:P.data.id===u.value},null,8,["modelValue"])]),_:1},8,["data"])])]),_:1},16,["zIndex","modelValue"])}}}),as=te({name:"FilePicker",__name:"index",props:we({title:{default:"文件选择"},modalProps:{},limit:{},fileLimit:{default:100},accept:{},params:{},groupDropdownProps:{},groupAddModalProps:{},renameModalProps:{},moveModalProps:{},fileListProps:{},selectionListProps:{},emptyProps:{},paginationProps:{},baseIndex:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:we(["done","close"],["update:modelValue"]),setup(e,{expose:t,emit:s}){const n=e,o=s,y=Fe(e,"modelValue"),{mobile:u}=fl(),i=_(null),d=_(null),l=_(null),I=_(!1),p=_([]),f=_(null),a=_(!1),c=_(null),h=_(!1),O=_(),P=_(!1),x=_(null),W=_(!1),X=_(),H=_(),ae=_([]);let E=null;const B=j(()=>{if(n.baseIndex!=null)return n.baseIndex+100}),k=j(()=>B.value==null?3e3:B.value+100),D=_(),G=_(),F=pl({inner:!0,appendTo:D}),ee=$l({appendTo:G}),de=M=>[{title:"重命名",command:"rename",icon:Ie(qe)},{title:"添加分组",command:"add",icon:Ie(hl),iconStyle:{transform:"scale(0.92)"}},{title:"删除分组",command:"remove",icon:Ie(ct),divided:!0,danger:!0}],ce=()=>{X.value&&X.value.handleClose()},me=(M,U)=>{M==null||H.value===M||E!=null&&E===U||(ce(),$e(()=>{E=U,ae.value=de()||[],H.value=M,ae.value.length&&$e(()=>{X.value&&X.value.handleOpen()})}))},ne=(M,U)=>{var ge,he,fe,Ce;f.value!=null&&u.value&&((he=(ge=i.value)==null?void 0:ge.toggleCollapse)==null||he.call(ge,!0)),M&&M.id!=null&&(U||(Ce=(fe=d.value)==null?void 0:fe.setSelectedGroup)==null||Ce.call(fe,M),(f.value==null||f.value.id!==M.id)&&(f.value=M,A(M.id)))},V=()=>{W.value?A():z()},q=M=>{W.value=!1,O.value=M?M.id:void 0,h.value=!0},T=(M,U)=>{W.value=!!U,c.value=M,a.value=!0},r=(M,U)=>{W.value=!!U,x.value=M,P.value=!0},m=(M,U)=>{var ge,he,fe,Ce,Re;W.value=!!U,(Re=(Ce=(fe=(he=(ge=ee==null?void 0:ee.confirm)==null?void 0:ge.call(ee,`确定要删除“${M.name}”吗?`,"系统提示",{type:"warning",draggable:!0}))==null?void 0:he.then)==null?void 0:fe.call(he,()=>{var Xe;const Z=(Xe=F==null?void 0:F.loading)==null?void 0:Xe.call(F,{message:"请求中..",plain:!0});$o(M.id).then(xe=>{var Me,Oe;(Me=Z==null?void 0:Z.close)==null||Me.call(Z),(Oe=F==null?void 0:F.success)==null||Oe.call(F,xe),V()}).catch(xe=>{var Me,Oe;(Me=Z==null?void 0:Z.close)==null||Me.call(Z),(Oe=F==null?void 0:F.error)==null||Oe.call(F,xe.message)})}))==null?void 0:Ce.catch)==null||Re.call(Ce,()=>{})},S=M=>{E!=null&&(M==="rename"?T(E):M==="add"?q(E):M==="remove"&&m(E))},$=()=>{I.value=!1},R=()=>{I.value=!0},z=()=>{R(),wo({isDirectory:1}).then(M=>{const U=[{id:-1,name:"全部"},{id:0,name:"未分组"},...vl({data:M,idField:"id",parentIdField:"parentId"})];p.value=U;const ge=f.value==null?void 0:gl(U,he=>{var fe;return he.id===((fe=f.value)==null?void 0:fe.id)});f.value=null,$e(()=>{ne(ge||U[0])})}).catch(M=>{p.value=[],F.error(M.message),$()})},A=M=>{R();const U=M==null?void 0:{page:1,name:"",parentId:M};l.value&&l.value.queryData(U)},ie=()=>{l.value&&l.value.clearSelections()},Se=()=>{ie(),z()},ve=()=>{ie(),o("close")},Ct=()=>{y.value=!1},bt=()=>{var M,U;R(),o("done",((U=(M=l.value)==null?void 0:M.getSelections)==null?void 0:U.call(M))||[])};return t({hideLoading:$}),(M,U)=>{const ge=kl,he=yl,fe=at,Ce=De,Re=Ae;return g(),Q(Re,le({width:988,title:M.title,position:"center",zIndex:M.baseIndex},M.modalProps||{},{modelValue:y.value,"onUpdate:modelValue":U[5]||(U[5]=Z=>y.value=Z),class:"file-picker-modal",onOpen:Se,onClose:ve}),{footer:C(()=>[v(Ce,{onClick:Ct},{default:C(()=>[ue("取消")]),_:1}),v(Ce,{type:"primary",onClick:bt},{default:C(()=>[ue("确定")]),_:1})]),default:C(()=>[v(ge,{ref_key:"splitRef",ref:i,space:"0px",size:"186px",flexTable:!0,allowCollapse:w(u),customStyle:{borderWidth:"0 1px 0 0"},class:"file-picker-wrapper"},{body:C(()=>{var Z;return[v(Ao,{ref_key:"fileListRef",ref:l,limit:M.limit,parentId:(Z=f.value)==null?void 0:Z.id,fileLimit:M.fileLimit,accept:M.accept,params:M.params,fileListProps:M.fileListProps,selectionListProps:M.selectionListProps,emptyProps:M.emptyProps,paginationProps:M.paginationProps,baseIndex:B.value,messageIns:w(F),onQueryStart:R,onQueryDone:$,onRenameFile:T,onMoveFile:r,onRemoveFile:m,onFileItemContextOpen:ce},null,8,["limit","parentId","fileLimit","accept","params","fileListProps","selectionListProps","emptyProps","paginationProps","baseIndex","messageIns"])]}),default:C(()=>[v(Co,{ref_key:"fileGroupRef",ref:d,groupData:p.value,onGroupSelect:ne,onAddBtnClick:U[0]||(U[0]=Z=>q()),onMoreIconClick:me,onHideGroupCtxMenu:U[1]||(U[1]=Z=>ce())},null,8,["groupData"])]),_:1},8,["allowCollapse"]),v(he,{loading:I.value,class:"file-picker-loading"},null,8,["loading"]),v(Bo,{modelValue:h.value,"onUpdate:modelValue":U[2]||(U[2]=Z=>h.value=Z),parentId:O.value,groupData:p.value,modalProps:M.groupAddModalProps,baseIndex:B.value,messageIns:w(F),onDone:V},null,8,["modelValue","parentId","groupData","modalProps","baseIndex","messageIns"]),v(Uo,{modelValue:a.value,"onUpdate:modelValue":U[3]||(U[3]=Z=>a.value=Z),data:c.value,modalProps:M.renameModalProps,baseIndex:B.value,messageIns:w(F),onDone:V},null,8,["modelValue","data","modalProps","baseIndex","messageIns"]),v(Go,{modelValue:P.value,"onUpdate:modelValue":U[4]||(U[4]=Z=>P.value=Z),data:x.value,groupData:p.value,modalProps:M.moveModalProps,baseIndex:B.value,messageIns:w(F),onDone:V},null,8,["modelValue","data","groupData","modalProps","baseIndex","messageIns"]),v(fe,le({triggerKeys:[],persistent:!1,zIndex:B.value,placement:"bottom-end",iconProps:{size:15},popperOptions:{strategy:"fixed",modifiers:[{name:"offset",options:{offset:[6,6]}}]}},M.groupDropdownProps||{},{ref_key:"ctxMenuDropdownRef",ref:X,trigger:"click",componentType:"pro",preventContextmenu:!0,virtualTriggering:!0,virtualRef:H.value,items:ae.value,onCommand:S}),null,16,["zIndex","virtualRef","items"]),b("div",{ref_key:"messageWrapRef",ref:D,class:"ele-message-wrapper",style:ke({position:"fixed",zIndex:k.value})},null,4),b("div",{ref_key:"messageBoxWrapRef",ref:G,class:"ele-message-box-wrapper",style:ke({position:"fixed",zIndex:k.value})},null,4)]),_:1},16,["title","zIndex","modelValue"])}}});export{as as _,_o as a,ze as b,In as c,Ye as d,$o as e,An as f,os as g,ho as h,On as i,wo as l,ss as r,kt as u};
