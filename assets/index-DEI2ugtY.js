import{i as Q}from"./index-B3KaCODP.js";import{d as B,a as W,o as P,c as R,e as t,f as e,A as X,j as q,i as v,g as I,k as N,l as S,y as M,x as K,s as A,m as j,r as u,u as Y,b as Z,E as U,n as O,z as ee,P as te,B as le,D as oe,cA as ae}from"./index-BiiIy8BH.js";import{i as z}from"./index-CIoy1qQK.js";import{i as ne}from"./index-BQNCTEdX.js";import"./index-DkgahQ27.js";import"./index-n3iKJaD_.js";import"./index-C6LSuDqi.js";import"./empty-B_ITTikW.js";import"./virtual-list-8KMurCcU.js";import"./index-ZMGHT5nN.js";import"./index-BQkjKN4u.js";import{E as re}from"./link-B4panqSh.js";import{E as L,a as G}from"./col-C4RHHrqY.js";import{_ as se}from"./index.vue_vue_type_style_index_0_lang-Dv3ffOhN.js";import{_ as ie}from"./index.vue_vue_type_script_setup_true_lang-BHYYbHid.js";import"./vuedraggable.umd-CNv-yK7O.js";import"./index.vue_vue_type_style_index_0_lang-B8Ks5WcW.js";import"./index-B9kzOIud.js";import"./tree-BvQcSpbV.js";import"./upload-BGO06KGh.js";import"./progress-CCLXG-1J.js";import"./throttle-DiptQJvM.js";import"./tree-select-B4mwEyeh.js";import"./message-box-D2dYDAIw.js";const ce=B({__name:"article-search",emits:["search"],setup(m,{emit:n}){const b=n,[y,h]=W({title:""}),f=()=>{b("search",{...y})},_=()=>{h(),f()};return(w,s)=>{const p=N,g=S,c=L,o=M,l=G,r=K,x=z;return P(),R(x,{"body-style":{paddingBottom:"2px"}},{default:t(()=>[e(r,{"label-width":"72px",onKeyup:X(f,["enter"]),onSubmit:s[1]||(s[1]=q(()=>{},["prevent"]))},{default:t(()=>[e(l,{gutter:8},{default:t(()=>[e(c,{lg:8,md:12,sm:12,xs:24},{default:t(()=>[e(g,{label:"标题"},{default:t(()=>[e(p,{clearable:"",modelValue:v(y).title,"onUpdate:modelValue":s[0]||(s[0]=E=>v(y).title=E),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{lg:8,md:12,sm:12,xs:24},{default:t(()=>[e(g,{"label-width":"16px"},{default:t(()=>[e(o,{type:"primary",onClick:f},{default:t(()=>[I("查询")]),_:1}),e(o,{onClick:_},{default:t(()=>[I("重置")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}});async function T(m){const n=await A.Post("/article/list",m);return n.code===0?n.data:Promise.reject(new Error(n.message))}async function de(m){const n=await A.Post("/article",m);return n.code===0?n.message:Promise.reject(new Error(n.message))}async function ue(m){const n=await A.Put("/article",m);return n.code===0?n.message:Promise.reject(new Error(n.message))}const me=B({__name:"article-edit",props:j({data:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:j(["done"],["update:modelValue"]),setup(m,{emit:n}){const b=m,y=n,h=u(null),f=u({height:520,category:0}),_=u(""),w=Y(m,"modelValue"),s=u(!1),p=u(!1),g=u(null),[c,o,l]=W({articleId:0,title:"",content:"",headImage:""}),r=Z({articleId:[{required:!0,type:"number",message:"请输入用户ID",trigger:"blur"}],title:[{required:!0,type:"string",message:"请输入帐号",trigger:"blur"}],content:[{required:!0,type:"string",message:"请输入呢称",trigger:"blur"}],headImage:[{required:!0,type:"string",message:"请输入主图",trigger:"blur"}]}),x=()=>{w.value=!1},E=()=>{var d,a;(a=(d=g.value)==null?void 0:d.validate)==null||a.call(d,i=>{if(!i)return;p.value=!0,(s.value?ue:de)(c).then(k=>{p.value=!1,U.success(k),x(),y("done")}).catch(k=>{p.value=!1,U.error(k.message)})})},$=()=>{b.data?(l({...b.data}),s.value=!0):(o(),s.value=!1),O(()=>{O(()=>{var d,a;(a=(d=g.value)==null?void 0:d.clearValidate)==null||a.call(d)})})};return(d,a)=>{const i=N,C=S,k=L,D=G,H=K,F=M,J=ee;return P(),R(J,{form:"",width:1024,modelValue:w.value,"onUpdate:modelValue":a[4]||(a[4]=V=>w.value=V),title:s.value?"修改文章":"新建文章",onOpen:$},{footer:t(()=>[e(F,{onClick:x},{default:t(()=>[I("取消")]),_:1}),e(F,{type:"primary",loading:p.value,onClick:E},{default:t(()=>[I(" 保存")]),_:1},8,["loading"])]),default:t(()=>[e(H,{ref_key:"formRef",ref:g,model:v(c),rules:r,"label-width":"80px",onSubmit:a[3]||(a[3]=q(()=>{},["prevent"]))},{default:t(()=>[e(D,{gutter:16},{default:t(()=>[e(k,{sm:24,xs:24},{default:t(()=>[e(C,{label:"标题",name:"title"},{default:t(()=>[e(i,{clearable:"",maxlength:50,value:v(c).title,"onUpdate:value":a[0]||(a[0]=V=>v(c).title=V),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1}),e(k,{sm:24,xs:24},{default:t(()=>[e(C,{label:"主图",name:"headImage"},{default:t(()=>[e(ie,{limit:1,modelValue:v(c).headImage,"onUpdate:modelValue":a[1]||(a[1]=V=>v(c).headImage=V),category:"article",drag:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(D,{gutter:16},{default:t(()=>[e(k,{sm:24,xs:24},{default:t(()=>[e(se,{ref_key:"editorRef",ref:h,init:f.value,modelValue:_.value,"onUpdate:modelValue":a[2]||(a[2]=V=>_.value=V),category:"article",disabled:!1},null,8,["init","modelValue"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),pe=["src"],Oe=B({__name:"index",setup(m){const n=u(null),b=u(null),y=u([{prop:"articleId",label:"用户ID",width:60,align:"left",fixed:"left"},{prop:"title",label:"标题",minWidth:110,align:"left"},{prop:"headImage",label:"主图",minWidth:110,align:"left",slot:"headImage"},{prop:"viewCount",label:"浏览次数",minWidth:110,align:"left"},{prop:"likeCount",label:"点赞次数",minWidth:110,align:"left"},{label:"时间",prop:"createTime",align:"left",minWidth:110},{columnKey:"action",label:"操作",width:200,align:"center",slot:"action",hideInPrint:!0,hideInExport:!0}]),h=u([]),f=u(null),_=u(!1),w=({pages:o,where:l,orders:r})=>T({...l,...r,...o}),s=o=>{var l,r;h.value=[],(r=(l=b.value)==null?void 0:l.reload)==null||r.call(l,{page:1,where:o})},p=o=>{f.value=o!=null?o:null,_.value=!0},g=o=>{oe.confirm("确定要删除“"+o.articleId+"”吗?","系统提示",{type:"warning",draggable:!0}).then(()=>{const l=U.loading({message:"请求中..",plain:!0});removeArticle(o.articleId).then(r=>{l.close(),U.success(r),s()}).catch(r=>{l.close(),U.error(r.message)})}).catch(()=>{})},c=({where:o,orders:l})=>T({...o,...l});return(o,l)=>{const r=M,x=re,E=ae,$=ne,d=z,a=Q;return P(),R(a,null,{default:t(()=>[e(d,{"body-style":{paddingTop:"8px"}},{default:t(()=>[e(ce,{ref_key:"searchRef",ref:n,style:{"margin-bottom":"-14px"},onSearch:s},null,512),e($,{ref_key:"tableRef",ref:b,"row-key":"articleId",columns:y.value,datasource:w,"show-overflow-tooltip":!0,border:!0,selections:h.value,"onUpdate:selections":l[1]||(l[1]=i=>h.value=i),"highlight-current-row":!0,"export-config":{fileName:"文章",datasource:c},"print-config":{datasource:c},"footer-style":{paddingBottom:"16px"},"cache-key":"systemUserTable"},{toolbar:t(()=>[e(r,{type:"primary",class:"ele-btn-icon",icon:v(te),onClick:l[0]||(l[0]=i=>p())},{default:t(()=>[I(" 新建 ")]),_:1},8,["icon"])]),headImage:t(({row:i})=>[le("img",{src:i.headImage,alt:"",style:{width:"100px",height:"100px","object-fit":"cover"}},null,8,pe)]),action:t(({row:i})=>[e(x,{type:"primary",underline:!1,onClick:C=>p(i)},{default:t(()=>[I(" 修改 ")]),_:2},1032,["onClick"]),e(E,{direction:"vertical"}),e(x,{type:"danger",underline:!1,onClick:C=>g(i)},{default:t(()=>[I(" 删除 ")]),_:2},1032,["onClick"])]),_:1},8,["columns","selections","export-config","print-config"])]),_:1}),e(me,{data:f.value,modelValue:_.value,"onUpdate:modelValue":l[2]||(l[2]=i=>_.value=i),onDone:s},null,8,["data","modelValue"])]),_:1})}}});export{Oe as default};
