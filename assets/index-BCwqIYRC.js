import{i as ae}from"./index-B3KaCODP.js";import{s as C,t as w,d as $,m as O,v as I,u as le,r as A,a as z,b as ne,w as oe,o as B,c as D,e as a,f as e,g as y,h as F,i as t,j as P,E as W,n as K,k as L,l as H,p as re,q as se,x as J,y as S,z as ie,A as de,B as T,C as me,P as ce,D as ue,_ as pe}from"./index-BiiIy8BH.js";import{i as Q}from"./index-CIoy1qQK.js";import{i as ge}from"./index-BQNCTEdX.js";import"./index-DkgahQ27.js";import"./index-n3iKJaD_.js";import"./index-C6LSuDqi.js";import"./empty-B_ITTikW.js";import"./virtual-list-8KMurCcU.js";import"./index-ZMGHT5nN.js";import"./index-BQkjKN4u.js";import{E as fe}from"./link-B4panqSh.js";import{E as he}from"./input-number-DVnd-AS5.js";import{E as X,a as Y}from"./col-C4RHHrqY.js";import"./vuedraggable.umd-CNv-yK7O.js";import"./index-DwKLMxIz.js";async function G(f){const l=await C.Post("/acting/GetMerchantActing",f);return l.code===0?l.data:Promise.reject(new Error(w("msg."+l.message)))}async function _e(f){const l=await C.Post("/acting/AddMerchant",f);return l.code===0?w("msg."+l.message):Promise.reject(new Error(w("msg."+l.message)))}async function be(f){const l=await C.Post("/acting/UpdateMerchantData",f);return l.code===0?w("msg."+l.message):Promise.reject(new Error(w("msg."+l.message)))}async function Ae(f){const l=await C.Post("/acting/DeleMerchant",f);return l.code===0?w("msg."+l.message):Promise.reject(new Error(w("msg."+l.message)))}const ve=$({__name:"merchant-edit",props:O({data:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:O(["done"],["update:modelValue"]),setup(f,{emit:l}){const{t:r}=I.useI18n(),v=f,x=l,M=le(f,"modelValue"),u=A(!1),b=A(!1),R=A(null),[o,k,E]=z({id:void 0,remark:void 0,password:void 0,state:1,merchantNum:void 0,merchantName:void 0,address:void 0,inFeeRates:void 0,inFeeNum:void 0,inActFeeRates:void 0,inActFeeNum:void 0,outFeeRates:void 0,outFeeNum:void 0,outActFeeRates:void 0,outActFeeNum:void 0,fatherMerchant:void 0});let N=ne({merchantNum:[{required:!0,message:r("getMerchantActing.placeholder.merchantNum"),type:"string",trigger:"blur"}],merchantName:[{required:!0,message:r("getMerchantActing.placeholder.merchantName"),type:"string",trigger:"blur"}],password:[{required:!!u,message:r("getMerchantActing.placeholder.password"),type:"string",trigger:"blur"}]});const d=A(r("getMerchantActing.placeholder.password"));oe(u,g=>{N.password&&(N.password[0].required=!g,g?d.value=r("common.defalutPwd"):d.value=r("getMerchantActing.placeholder.password"))});const m=()=>{M.value=!1},p=()=>{var g,n,h;o.id=((g=v.data)==null?void 0:g._id)||"",console.log("id",o),(h=(n=R.value)==null?void 0:n.validate)==null||h.call(n,s=>{if(!s)return;b.value=!0,(u.value?be:_e)(o).then(_=>{b.value=!1,W.success(_),m(),x("done")}).catch(_=>{b.value=!1,W.error(_.message)})})},U=()=>{var g;v.data?(E({...v.data,id:(g=v.data)==null?void 0:g._id,password:void 0}),u.value=!0):(k(),u.value=!1),K(()=>{K(()=>{var n,h;(h=(n=R.value)==null?void 0:n.clearValidate)==null||h.call(n)})})};return(g,n)=>{const h=L,s=H,c=X,_=Y,V=he,j=re,Z=se,ee=J,q=S,te=ie;return B(),D(te,{form:"",width:730,modelValue:M.value,"onUpdate:modelValue":n[14]||(n[14]=i=>M.value=i),title:u.value?t(r)("getMerchantActing.action.editMerchant"):t(r)("getMerchantActing.action.addMerchant"),onOpen:U},{footer:a(()=>[e(q,{onClick:m},{default:a(()=>[y(F(t(r)("action.cancel")),1)]),_:1}),e(q,{type:"primary",loading:b.value,onClick:p},{default:a(()=>[y(F(t(r)("action.save")),1)]),_:1},8,["loading"])]),default:a(()=>[e(ee,{ref_key:"formRef",ref:R,model:t(o),rules:t(N),"label-width":"80px",onSubmit:n[13]||(n[13]=P(()=>{},["prevent"])),"label-position":"top"},{default:a(()=>[e(_,{gutter:20},{default:a(()=>[e(c,{lg:12,md:12,sm:12,xs:12},{default:a(()=>[e(s,{label:t(r)("getMerchantActing.table.merchantNum"),prop:"merchantNum"},{default:a(()=>[e(h,{clearable:"",disabled:u.value,maxlength:20,modelValue:t(o).merchantNum,"onUpdate:modelValue":n[0]||(n[0]=i=>t(o).merchantNum=i),placeholder:t(r)("getMerchantActing.placeholder.merchantNum")},null,8,["disabled","modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{lg:12,md:12,sm:12,xs:12},{default:a(()=>[e(s,{label:t(r)("getMerchantActing.table.merchantName"),prop:"merchantName"},{default:a(()=>[e(h,{clearable:"",maxlength:20,modelValue:t(o).merchantName,"onUpdate:modelValue":n[1]||(n[1]=i=>t(o).merchantName=i),placeholder:t(r)("getMerchantActing.placeholder.merchantName")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),e(_,{gutter:20},{default:a(()=>[e(c,{lg:24,md:24,sm:24,xs:24},{default:a(()=>[e(s,{label:t(r)("getMerchantActing.table.password"),prop:"password"},{default:a(()=>[e(h,{"show-password":"",type:"password",maxlength:20,modelValue:t(o).password,"onUpdate:modelValue":n[2]||(n[2]=i=>t(o).password=i),placeholder:d.value},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),e(_,{gutter:20},{default:a(()=>[e(c,{lg:12,md:12,sm:12,xs:12},{default:a(()=>[e(s,{label:t(r)("getMerchantActing.table.inFeeRates")},{default:a(()=>[e(V,{modelValue:t(o).inFeeRates,"onUpdate:modelValue":n[3]||(n[3]=i=>t(o).inFeeRates=i),min:0,max:1,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{lg:12,md:12,sm:12,xs:12},{default:a(()=>[e(s,{label:t(r)("getMerchantActing.table.outFeeRates")},{default:a(()=>[e(V,{modelValue:t(o).outFeeRates,"onUpdate:modelValue":n[4]||(n[4]=i=>t(o).outFeeRates=i),min:0,max:1,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(_,{gutter:20},{default:a(()=>[e(c,{lg:12,md:12,sm:12,xs:12},{default:a(()=>[e(s,{label:t(r)("getMerchantActing.table.inFeeNum")},{default:a(()=>[e(V,{modelValue:t(o).inFeeNum,"onUpdate:modelValue":n[5]||(n[5]=i=>t(o).inFeeNum=i),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{lg:12,md:12,sm:12,xs:12},{default:a(()=>[e(s,{label:t(r)("getMerchantActing.table.outFeeNum")},{default:a(()=>[e(V,{modelValue:t(o).outFeeNum,"onUpdate:modelValue":n[6]||(n[6]=i=>t(o).outFeeNum=i),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(_,{gutter:20},{default:a(()=>[e(c,{lg:12,md:12,sm:12,xs:12},{default:a(()=>[e(s,{label:t(r)("getMerchantActing.table.inActFeeRates")},{default:a(()=>[e(V,{modelValue:t(o).inActFeeRates,"onUpdate:modelValue":n[7]||(n[7]=i=>t(o).inActFeeRates=i),min:0,max:1,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{lg:12,md:12,sm:12,xs:12},{default:a(()=>[e(s,{label:t(r)("getMerchantActing.table.outActFeeRates")},{default:a(()=>[e(V,{modelValue:t(o).outActFeeRates,"onUpdate:modelValue":n[8]||(n[8]=i=>t(o).outActFeeRates=i),min:0,max:1,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(_,{gutter:20},{default:a(()=>[e(c,{lg:12,md:12,sm:12,xs:12},{default:a(()=>[e(s,{label:t(r)("getMerchantActing.table.inActFeeNum")},{default:a(()=>[e(V,{modelValue:t(o).inActFeeNum,"onUpdate:modelValue":n[9]||(n[9]=i=>t(o).inActFeeNum=i),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{lg:12,md:12,sm:12,xs:12},{default:a(()=>[e(s,{label:t(r)("getMerchantActing.table.outActFeeNum")},{default:a(()=>[e(V,{modelValue:t(o).outActFeeNum,"onUpdate:modelValue":n[10]||(n[10]=i=>t(o).outActFeeNum=i),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(_,{gutter:20},{default:a(()=>[e(c,{lg:12,md:12,sm:12,xs:12},{default:a(()=>[e(s,{label:t(r)("getMerchantActing.table.state")},{default:a(()=>[e(Z,{modelValue:t(o).state,"onUpdate:modelValue":n[11]||(n[11]=i=>t(o).state=i)},{default:a(()=>[e(j,{value:1,label:t(r)("action.open")},null,8,["label"]),e(j,{value:0,label:t(r)("action.close")},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(_,{gutter:20},{default:a(()=>[e(c,{lg:24,md:24,sm:24,xs:24},{default:a(()=>[e(s,{label:t(r)("getMerchantActing.table.remark")},{default:a(()=>[e(h,{rows:4,type:"textarea",modelValue:t(o).remark,"onUpdate:modelValue":n[12]||(n[12]=i=>t(o).remark=i),placeholder:t(r)("getMerchantActing.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),Me=$({__name:"merchant-search",emits:["search"],setup(f,{emit:l}){const{t:r}=I.useI18n(),v=l,[x,M]=z({id:void 0,merchantNum:void 0}),u=()=>{v("search",{...x})},b=()=>{M(),u()};return(R,o)=>{const k=L,E=H,N=X,d=S,m=Y,p=J,U=Q;return B(),D(U,{"body-style":{paddingBottom:"2px"}},{default:a(()=>[e(p,{onKeyup:de(P(u,["prevent"]),["enter"]),onSubmit:o[1]||(o[1]=P(()=>{},["prevent"]))},{default:a(()=>[e(m,{gutter:8},{default:a(()=>[e(N,{lg:6,md:8,sm:12,xs:24},{default:a(()=>[e(E,{label:t(r)("getMerchantActing.table.merchantNum")},{default:a(()=>[e(k,{clearable:"",modelValue:t(x).merchantNum,"onUpdate:modelValue":o[0]||(o[0]=g=>t(x).merchantNum=g),modelModifiers:{trim:!0},placeholder:t(r)("getMerchantActing.placeholder.merchantNum")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(N,{lg:12,md:8,sm:24,xs:24},{default:a(()=>[e(E,{"label-width":"16px"},{default:a(()=>[e(d,{type:"primary",onClick:u},{default:a(()=>[y(F(t(r)("action.search")),1)]),_:1}),e(d,{onClick:b},{default:a(()=>[y(F(t(r)("action.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["onKeyup"])]),_:1})}}}),Ne=$({name:"SystemRole",__name:"index",setup(f){const{t:l}=I.useI18n(),r=A(null),v=A(null),x=A([{type:"index",label:l("getMerchantActing.table.index"),width:80,align:"center",fixed:"left"},{prop:"merchantNum",label:l("getMerchantActing.table.merchantNum"),align:"center",minWidth:100},{prop:"merchantName",label:l("getMerchantActing.table.merchantName"),align:"center",minWidth:100},{prop:"state",label:l("getMerchantActing.table.state"),minWidth:90,align:"center",slot:"state",formatter:d=>d.state==0?l("action.close"):l("action.open")},{prop:"gold",label:l("getMerchantActing.table.gold"),minWidth:100,align:"center"},{prop:"inFeeRates",label:l("getMerchantActing.table.inFeeRates"),minWidth:170,align:"center"},{prop:"outFeeRates",label:l("getMerchantActing.table.outFeeRates"),minWidth:170,align:"center"},{prop:"inFeeNum",label:l("getMerchantActing.table.inFeeNum"),minWidth:170,align:"center"},{prop:"outFeeNum",label:l("getMerchantActing.table.outFeeNum"),minWidth:170,align:"center"},{prop:"inActFeeRates",label:l("getMerchantActing.table.inActFeeRates"),minWidth:170,align:"center"},{prop:"outActFeeRates",label:l("getMerchantActing.table.outActFeeRates"),minWidth:170,align:"center"},{prop:"inActFeeNum",label:l("getMerchantActing.table.inActFeeNum"),minWidth:180,align:"center"},{prop:"outActFeeNum",label:l("getMerchantActing.table.outActFeeNum"),minWidth:190,align:"center"},{prop:"address",label:l("getMerchantActing.table.address"),minWidth:120,align:"center",slot:"address"},{prop:"remark",label:l("getMerchantActing.table.remark"),minWidth:120},{columnKey:"action",label:l("getMerchantActing.table.action"),width:200,align:"center",slot:"action",fixed:"right",hideInPrint:!0,hideInExport:!0}]),M=A([]),u=A(null),b=A(!1),R=({pages:d,where:m,orders:p})=>G({...m,...p,...d}),o=d=>{var m,p;M.value=[],(p=(m=v.value)==null?void 0:m.reload)==null||p.call(m,{page:1,where:d})},k=d=>{u.value=d!=null?d:null,b.value=!0},E=d=>{ue.confirm(`${l("common.needDel")}${d.merchantName} " ?`,l("common.tips"),{type:"warning",draggable:!0}).then(()=>{const m=W.loading({message:l("common.loading"),plain:!0});Ae({merchantName:d.merchantName,id:d._id}).then(p=>{m.close(),W.success(p),o()}).catch(p=>{m.close(),W.error(p.message)})}).catch(()=>{})},N=({where:d,orders:m})=>G({...d,...m});return(d,m)=>{const p=S,U=fe,g=ge,n=Q,h=ae;return B(),D(h,null,{default:a(()=>[e(Me,{ref_key:"searchRef",ref:r,style:{"margin-bottom":"-14px"},onSearch:o},null,512),e(n,{"body-style":{paddingTop:"8px"}},{default:a(()=>[e(g,{ref_key:"tableRef",ref:v,"row-key":"_id",columns:x.value,headerEllipsis:!1,datasource:R,border:!0,"show-overflow-tooltip":!0,selections:M.value,"onUpdate:selections":m[1]||(m[1]=s=>M.value=s),"highlight-current-row":!0,"export-config":{fileName:t(l)("permission.GetMerchantActing"),datasource:N},"print-config":{datasource:N},"cache-key":"systemRoleTable"},{address:a(({row:s})=>[T("span",null,F(s.address?s.address.length:0),1)]),state:a(({row:s})=>[T("span",{style:me({color:s.state==1?"#67c23a":"#f56c6c"})},F(s.state==1?t(l)("action.open"):t(l)("action.close")),5)]),toolbar:a(()=>[e(p,{type:"primary",class:"ele-btn-icon",icon:t(ce),onClick:m[0]||(m[0]=s=>k())},{default:a(()=>[y(F(t(l)("action.add")),1)]),_:1},8,["icon"])]),action:a(({row:s})=>[e(U,{type:"primary",underline:!1,onClick:c=>k(s)},{default:a(()=>[y(F(t(l)("action.edit")),1)]),_:2},1032,["onClick"]),e(U,{type:"danger",underline:!1,onClick:c=>E(s)},{default:a(()=>[y(F(t(l)("action.del")),1)]),_:2},1032,["onClick"])]),_:1},8,["columns","selections","export-config","print-config"])]),_:1}),e(ve,{modelValue:b.value,"onUpdate:modelValue":m[2]||(m[2]=s=>b.value=s),data:u.value,onDone:o},null,8,["modelValue","data"])]),_:1})}}}),Se=pe(Ne,[["__scopeId","data-v-a074bb66"]]);export{Se as default};
